"use strict";(self.webpackChunkbrightplanet_ventures=self.webpackChunkbrightplanet_ventures||[]).push([[855],{1065:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(3797).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},3395:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(3797).A)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},3489:(e,t,s)=>{s.d(t,{A:()=>n,r:()=>o});var i=s(9379),r=s(3792),a=s(3848);const o={TOTAL_COMMISSION:800,LEVELS:{1:{amount:500,description:"Parent Promoter (Immediate Upline)"},2:{amount:100,description:"Next-Level Upline Promoter"},3:{amount:100,description:"Next-Level Upline Promoter"},4:{amount:100,description:"Next-Level Upline Promoter"}},STATUSES:{PENDING:"pending",CREDITED:"credited",FAILED:"failed"},RECIPIENT_TYPES:{PROMOTER:"promoter",ADMIN:"admin"}};const n=new class{async distributeCommission(e,t){try{a.Ay.info("\ud83c\udfaf Starting commission distribution",{customerId:e,initiatorPromoterId:t,totalAmount:o.TOTAL_COMMISSION});const c=await this.checkExistingCommission(e);if(c)return a.Ay.info("\u2139\ufe0f Commission already exists for customer - skipping distribution",{customerId:e,existingRecords:c.recordCount,totalDistributed:c.totalDistributed}),{success:!0,skipped:!0,message:"Commission already distributed for this customer (\u20b9".concat(c.totalDistributed," across ").concat(c.recordCount," records)"),existingCommission:c.allRecords,totalDistributed:c.totalDistributed,recordCount:c.recordCount};let l,m;try{a.Ay.info("\ud83c\udfaf Attempting database function: distribute_affiliate_commission");const s=await r.ND.rpc("distribute_affiliate_commission",{p_customer_id:e,p_initiator_promoter_id:t});if(l=s.data,m=s.error,l&&l.success)return a.Ay.info("\u2705 Database function succeeded, skipping fallback calculation"),{success:!0,data:l,message:"\u20b9".concat(l.total_distributed||o.TOTAL_COMMISSION," commission distributed via database function")};if(l&&l.skipped)return{success:!0,skipped:!0,data:l,message:l.message||"Commission already distributed"}}catch(n){var s,i;if(!(null!==(s=n.message)&&void 0!==s&&s.includes("Could not find the function")||null!==(i=n.message)&&void 0!==i&&i.includes("404")))throw n;a.Ay.warn("\u26a0\ufe0f Commission function not found, using fallback calculation",{customerId:e}),l=await this.calculateCommissionFallback(e,t),m=null}return m&&(a.Ay.error("\u274c Commission distribution failed",{error:m,customerId:e}),a.Ay.info("\ud83d\udd04 Attempting fallback commission calculation",{customerId:e}),l=await this.calculateCommissionFallback(e,t)),a.Ay.success("\u2705 Commission distribution completed",l),await this.triggerCommissionNotifications(l),{success:!0,data:l,message:"\u20b9".concat(o.TOTAL_COMMISSION," commission distributed successfully")}}catch(c){return a.Ay.error("\u274c Commission distribution service error",{error:c.message,customerId:e,initiatorPromoterId:t}),{success:!1,error:c.message}}}async calculateCommissionFallback(e,t){try{a.Ay.info("\ud83d\udcb0 Calculating commission using fallback method",{customerId:e,initiatorPromoterId:t});const i=[500,100,100,100];let o=t,n=0,c=0,l=800;for(let d=1;d<=4;d++){const m=i[d-1];if(o){try{const{error:s}=await r.ND.from("affiliate_commissions").insert({customer_id:e,initiator_promoter_id:t,recipient_id:o,recipient_type:"promoter",level:d,amount:m,status:"credited",transaction_id:"COM-".concat(String(Date.now()).slice(-6)),note:"Level ".concat(d," Commission - \u20b9").concat(m)});s?a.Ay.error("\u274c Failed to create commission record for level ".concat(d),s):(n+=m,l-=m,c++,a.Ay.info("\ud83d\udcb0 Level ".concat(d," commission: \u20b9").concat(m," to promoter ").concat(o," (\u20b9").concat(l," remaining in pool)")))}catch(s){a.Ay.error("\u274c Error creating commission record for level ".concat(d),s)}if(d<4)try{const{data:e,error:t}=await r.ND.from("profiles").select("parent_promoter_id, name, promoter_id").eq("id",o).single();!t&&null!==e&&void 0!==e&&e.parent_promoter_id?(o=e.parent_promoter_id,a.Ay.info("\ud83d\udd17 Moving to parent promoter: ".concat(o," for level ").concat(d+1))):(a.Ay.info("\ud83d\udeab No parent promoter found for level ".concat(d+1)),o=null)}catch(s){a.Ay.error("\u274c Error fetching parent promoter for level ".concat(d+1),s),o=null}}else a.Ay.info("\ud83d\udeab LEVEL ".concat(d," NO PROMOTER:"),{level:d,amount:m,message:"\u20b9".concat(m," stays in pool for admin"),remainingPool:l})}if(l>0)try{const{error:s}=await r.ND.from("affiliate_commissions").insert({customer_id:e,initiator_promoter_id:t,recipient_id:null,recipient_type:"admin",level:0,amount:l,status:"credited",transaction_id:"COM-".concat(String(Date.now()).slice(-6)),note:"Admin Fallback - Remaining from \u20b9800 pool - \u20b9".concat(l)});s?a.Ay.error("\u274c Failed to create admin commission record",s):(n+=l,a.Ay.info("\ud83d\udcb0 Admin commission: \u20b9".concat(l," from remaining pool")))}catch(s){a.Ay.error("\u274c Error creating admin commission record",s)}const m={success:!0,customer_id:e,initiator_promoter_id:t,total_distributed:n,levels_distributed:c,admin_fallback:l,timestamp:(new Date).toISOString(),method:"fallback_calculation",message:"Commission calculated via fallback: \u20b9".concat(n," distributed across ").concat(c," levels")};return this.storeCommissionRecord(m),m}catch(s){return a.Ay.error("\u274c Fallback commission calculation failed",{error:s,customerId:e}),{success:!0,customer_id:e,initiator_promoter_id:t,total_distributed:o.TOTAL_COMMISSION,levels_distributed:4,admin_fallback:0,timestamp:(new Date).toISOString(),method:"basic_fallback",message:"Commission recorded for manual processing"}}}storeCommissionRecord(e){try{const t=JSON.parse(localStorage.getItem("commission_audit_trail")||"[]");t.push((0,i.A)((0,i.A)({},e),{},{stored_at:(new Date).toISOString()})),t.length>100&&t.splice(0,t.length-100),localStorage.setItem("commission_audit_trail",JSON.stringify(t)),a.Ay.info("\ud83d\udcdd Commission record stored for audit",{customer_id:e.customer_id})}catch(t){a.Ay.error("\u274c Failed to store commission record",{error:t})}}async checkExistingCommission(e){try{const{data:t,error:s}=await r.ND.from("affiliate_commissions").select("id, customer_id, amount, recipient_type, status, created_at").eq("customer_id",e).eq("status","credited");if(s)throw s;if(t&&t.length>0){const s=t.reduce((e,t)=>e+parseFloat(t.amount),0);return a.Ay.warn("\ud83d\udeab Commission already exists for customer",{customerId:e,existingRecords:t.length,totalDistributed:s,records:t}),{exists:!0,recordCount:t.length,totalDistributed:s,firstRecord:t[0],allRecords:t}}return null}catch(t){return a.Ay.error("Error checking existing commission",{error:t,customerId:e}),null}}async getPromoterCommissionSummary(e){try{const{data:t,error:s}=await r.ND.rpc("get_promoter_commission_summary",{p_promoter_id:e});if(s)throw s;return{success:!0,data:t||{promoter_id:e,wallet_balance:0,total_earned:0,commission_count:0,recent_commissions:[]}}}catch(t){return a.Ay.error("Error getting promoter commission summary",{error:t,promoterId:e}),await this.getBasicWalletInfo(e)}}async getBasicWalletInfo(e){try{var t;const s=await fetch("".concat("https://api.brightplanetventures.com/api","/commission/wallet?promoterId=").concat(e)),i=await s.json();if(!i.success)throw new Error(i.message||"Failed to fetch wallet balance");const r=await fetch("".concat("https://api.brightplanetventures.com/api","/commission/history?promoterId=").concat(e,"&status=credited&limit=10")),a=await r.json();return{success:!0,data:{promoter_id:e,wallet_balance:i.data.availableBalance||0,total_earned:i.data.totalEarned||0,commission_count:(null===(t=a.data)||void 0===t?void 0:t.length)||0,recent_commissions:a.data||[]}}}catch(s){return a.Ay.error("Error getting basic wallet info",{error:s,promoterId:e}),{success:!1,error:s.message,data:{promoter_id:e,wallet_balance:0,total_earned:0,commission_count:0,recent_commissions:[]}}}}async getAdminCommissionSummary(){try{const{data:e,error:t}=await r.ND.rpc("get_admin_commission_summary");if(t)throw t;return{success:!0,data:e||{wallet_balance:0,total_received:0,unclaimed_total:0,commission_count:0,daily_summary:[]}}}catch(e){return a.Ay.error("Error getting admin commission summary",{error:e}),await this.getBasicAdminInfo()}}async getBasicAdminInfo(){try{const{data:e,error:t}=await r.ND.from("profiles").select("id").eq("role","admin").limit(1).single();if(t||!e)throw new Error("Admin not found");const s=JSON.parse(localStorage.getItem("admin_unclaimed_commissions")||"[]"),i=s.reduce((e,t)=>e+(t.amount||0),0),a=s.length,{data:o,error:n}=await r.ND.from("admin_wallet").select("*").eq("admin_id",e.id).single(),{data:c,error:l}=await r.ND.from("affiliate_commissions").select("*").eq("recipient_type","admin").order("created_at",{ascending:!1}).limit(20);return{success:!0,data:{admin_id:e.id,wallet_balance:((null===o||void 0===o?void 0:o.balance)||0)+i,total_received:(null===o||void 0===o?void 0:o.total_commission_received)||0,unclaimed_total:i,commission_count:((null===o||void 0===o?void 0:o.commission_count)||0)+a,recent_commissions:[...c||[],...s.slice(-10)]}}}catch(e){return a.Ay.error("Error getting basic admin info",{error:e}),{success:!1,error:e.message,data:{wallet_balance:0,total_received:0,unclaimed_total:0,commission_count:0,recent_commissions:[]}}}}async getCommissionHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t;const s=new URLSearchParams;e.promoterId&&s.append("promoterId",e.promoterId),e.level&&s.append("level",e.level),e.status&&s.append("status",e.status),e.dateFrom&&s.append("dateFrom",e.dateFrom),e.dateTo&&s.append("dateTo",e.dateTo);const i=await fetch("".concat("https://api.brightplanetventures.com/api","/commission/history?").concat(s)),r=await i.json();if(!r.success)throw new Error(r.message||"Failed to fetch commission history");return{success:!0,data:r.data||[],count:(null===(t=r.data)||void 0===t?void 0:t.length)||0,totals:r.totals||{totalEarned:0,totalCount:0}}}catch(s){return a.Ay.error("Error getting commission history",{error:s,filters:e}),{success:!1,error:s.message,data:[]}}}async triggerCommissionNotifications(e){try{a.Ay.info("\ud83d\udce2 Triggering commission notifications",e)}catch(t){a.Ay.error("Error triggering notifications",{error:t})}}async manualDistributeCommission(e,t,s){try{a.Ay.info("\ud83d\udd27 Manual commission distribution initiated",{customerId:e,initiatorPromoterId:t,adminId:s});const{data:i,error:o}=await r.ND.from("profiles").select("role").eq("id",s).eq("role","admin").single();if(o||!i)throw new Error("Unauthorized: Admin access required");return await this.distributeCommission(e,t)}catch(i){return a.Ay.error("\u274c Manual commission distribution failed",{error:i}),{success:!1,error:i.message}}}async getCommissionStatistics(){try{const{data:e,error:t}=await r.ND.from("affiliate_commissions").select("level, amount, status, created_at, recipient_type");if(t)throw t;const s={totalCommissions:e.length,totalAmount:e.reduce((e,t)=>e+parseFloat(t.amount),0),byLevel:{},byStatus:{},byRecipientType:{},monthlyTrend:{}};return e.forEach(e=>{s.byLevel[e.level]=(s.byLevel[e.level]||0)+1,s.byStatus[e.status]=(s.byStatus[e.status]||0)+1,s.byRecipientType[e.recipient_type]=(s.byRecipientType[e.recipient_type]||0)+1;const t=new Date(e.created_at).toISOString().substring(0,7);s.monthlyTrend[t]||(s.monthlyTrend[t]={count:0,amount:0}),s.monthlyTrend[t].count+=1,s.monthlyTrend[t].amount+=parseFloat(e.amount)}),{success:!0,data:s}}catch(e){return a.Ay.error("Error getting commission statistics",{error:e}),{success:!1,error:e.message,data:{}}}}}},3916:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(3797).A)("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]])},5275:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(3797).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},6487:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(3797).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},6950:(e,t,s)=>{s.d(t,{A:()=>i});const i=(0,s(3797).A)("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]])},7855:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(9379),r=s(5043),a=s(6621),o=s(1921),n=s(3216),c=s(3959),l=s(3489),m=s(3792),d=s(987),u=s(3395),x=s(917),g=s(3458),h=s(6950),p=s(4068),f=s(6487),y=s(5275),b=s(3916),w=s(1065),_=s(579);const v=function(){const{user:e}=(0,a.As)(),{showSuccess:t,showError:s}=(0,o.L5)(),v=(0,n.Zp)();(0,c.r9)();const[j,N]=(0,r.useState)(!0),[A,C]=(0,r.useState)("initial"),[k,I]=(0,r.useState)("summary"),[S,E]=(0,r.useState)({promoter_id:null===e||void 0===e?void 0:e.id,wallet_balance:0,total_earned:0,commission_count:0,recent_commissions:[]}),[D,T]=(0,r.useState)({}),[M,L]=(0,r.useState)({}),[O,F]=(0,r.useState)({page:1,limit:20,totalCount:0,hasMore:!1}),[R,P]=(0,r.useState)({level:"",status:"",dateFrom:"",dateTo:""}),q=async e=>{try{if(0===e.length)return;const{data:t,error:s}=await m.Ay.from("profiles").select("id, name, customer_id, promoter_id").in("id",[...new Set(e)]);if(t&&!s){const e={},s={};t.forEach(t=>{e[t.id]=t.name,s[t.id]=t.customer_id||t.promoter_id||t.id.substring(0,8)+"..."}),T(e),L(s)}}catch(t){}},z=async()=>{try{N(!0);const t=await l.A.getCommissionHistory((0,i.A)({promoterId:e.id},R));if(t.success){const s=await l.A.getBasicWalletInfo(e.id);E({promoter_id:null===e||void 0===e?void 0:e.id,wallet_balance:s.success?s.data.wallet_balance:0,total_earned:s.success?s.data.total_earned:0,commission_count:s.success?s.data.commission_count:0,recent_commissions:t.data||[]}),F({page:1,limit:20,totalCount:t.count||0,hasMore:!1})}}catch(t){s("Failed to load commission data")}finally{N(!1)}};(0,r.useEffect)(()=>{null!==e&&void 0!==e&&e.id&&z()},[null===e||void 0===e?void 0:e.id,R]);const U=(0,r.useMemo)(()=>S.recent_commissions?S.recent_commissions.filter(e=>{if(R.level&&e.level.toString()!==R.level)return!1;if(R.status&&e.status!==R.status)return!1;const t=new Date(e.created_at);if(R.dateFrom&&new Date(R.dateFrom)>t)return!1;if(R.dateTo){const e=new Date(R.dateTo);if(e.setHours(23,59,59,999),e<t)return!1}return!0}):[],[S.recent_commissions,R]),B=e=>{const t=parseFloat(e)||0;return"\u20b9".concat(t.toLocaleString("en-IN"))};return j?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.wE,{}),(0,_.jsx)(c.dQ,{children:(0,_.jsx)("div",{className:"min-h-screen pt-40 px-8 pb-8",children:(0,_.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,_.jsxs)("div",{className:"flex items-center justify-center mb-8","data-animate":!0,children:[(0,_.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,_.jsx)("div",{className:"w-3 h-3 rounded-full transition-all duration-300 ".concat("summary"===k?"bg-orange-400":"bg-gray-600")}),(0,_.jsx)("div",{className:"w-3 h-3 rounded-full transition-all duration-300 ".concat("details"===k?"bg-orange-400":"bg-gray-600")}),(0,_.jsx)("div",{className:"w-3 h-3 rounded-full transition-all duration-300 ".concat("complete"===k?"bg-orange-400":"bg-gray-600")})]}),(0,_.jsxs)("p",{className:"text-gray-400 text-sm ml-4",children:["summary"===k&&"Loading summary...","details"===k&&"Loading details...","complete"===k&&"Finalizing..."]})]}),(0,_.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(e=>(0,_.jsxs)("div",{className:"p-6 bg-gray-800/50 border border-gray-700/50 rounded-xl animate-pulse",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,_.jsx)("div",{className:"w-24 h-4 bg-gray-700 rounded"}),(0,_.jsx)("div",{className:"w-12 h-12 bg-gray-700 rounded-xl"})]}),(0,_.jsx)("div",{className:"w-32 h-8 bg-gray-700 rounded mb-2"}),(0,_.jsx)("div",{className:"w-20 h-3 bg-gray-700 rounded"})]},e))}),"details"===k&&(0,_.jsxs)("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-6",children:[(0,_.jsx)("div",{className:"h-4 bg-gray-700 rounded w-48 mb-4"}),(0,_.jsx)("div",{className:"space-y-3",children:[1,2,3,4,5].map(e=>(0,_.jsx)("div",{className:"h-12 bg-gray-700 rounded animate-pulse"},e))})]})]})})})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.wE,{}),(0,_.jsx)(c.dQ,{children:(0,_.jsx)("div",{className:"min-h-screen pt-40 px-8 pb-8",children:(0,_.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,_.jsxs)("div",{className:"flex justify-between items-center mb-8","data-animate":!0,children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Income"}),(0,_.jsx)("p",{className:"text-slate-400",children:"Track your affiliate commission earnings"})]}),(0,_.jsxs)(c.Rq,{onClick:()=>{z(),t("Commission data refreshed successfully.")},className:"flex items-center space-x-2",children:[(0,_.jsx)(p.A,{className:"w-5 h-5"}),(0,_.jsx)("span",{children:"Refresh"})]})]}),(0,_.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8","data-animate":!0,children:[(0,_.jsxs)(c.Xg,{className:"p-6",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("p",{className:"text-sm text-green-400 mb-1",children:"Wallet Balance"}),(0,_.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:B(S.wallet_balance)})]}),(0,_.jsx)("div",{className:"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center",children:(0,_.jsx)(b.A,{className:"w-6 h-6 text-green-400"})})]}),(0,_.jsxs)("div",{className:"flex items-center mt-4 text-xs text-green-500/70",children:[(0,_.jsx)("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-2"}),"Available for withdrawal"]})]}),(0,_.jsxs)(c.Xg,{className:"p-6",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("p",{className:"text-sm text-orange-400 mb-1",children:"Total Earned"}),(0,_.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:B(S.total_earned)})]}),(0,_.jsx)("div",{className:"w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center",children:(0,_.jsx)(y.A,{className:"w-6 h-6 text-orange-400"})})]}),(0,_.jsxs)("div",{className:"flex items-center mt-4 text-xs text-orange-500/70",children:[(0,_.jsx)("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full mr-2"}),"Lifetime credit earnings"]})]}),(0,_.jsxs)(c.Xg,{className:"p-6",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("p",{className:"text-sm text-purple-400 mb-1",children:"Commissions"}),(0,_.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:S.commission_count})]}),(0,_.jsx)("div",{className:"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center",children:(0,_.jsx)(u.A,{className:"w-6 h-6 text-purple-400"})})]}),(0,_.jsxs)("div",{className:"flex items-center mt-4 text-xs text-purple-500/70",children:[(0,_.jsx)("div",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mr-2"}),"Total payouts received"]})]}),(0,_.jsxs)(c.Xg,{className:"p-6",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("p",{className:"text-sm text-blue-400 mb-1",children:"Average Earned"}),(0,_.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:B(S.commission_count>0?S.total_earned/S.commission_count:0)})]}),(0,_.jsx)("div",{className:"w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center",children:(0,_.jsx)(f.A,{className:"w-6 h-6 text-blue-400"})})]}),(0,_.jsxs)("div",{className:"flex items-center mt-4 text-xs text-blue-500/70",children:[(0,_.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2"}),"Average per assignment"]})]})]}),(0,_.jsxs)(c.Xg,{className:"overflow-hidden",variant:"glassDark","data-animate":!0,children:[(0,_.jsx)("div",{className:"p-6 border-b border-gray-700/50",children:(0,_.jsxs)("div",{className:"flex items-center justify-between",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"text-2xl font-semibold text-white",children:"Recent Income"}),(0,_.jsx)("p",{className:"text-gray-300 text-sm mt-1",children:"Your latest earnings"})]}),(0,_.jsx)("div",{className:"flex items-center space-x-3",children:(0,_.jsxs)(c.Rq,{onClick:()=>v("/promoter/pin-management"),className:"flex items-center space-x-2 bg-gradient-to-r from-orange-500 to-yellow-500",children:[(0,_.jsx)(h.A,{className:"w-4 h-4"}),(0,_.jsx)("span",{children:"PIN Management"})]})})]})}),(0,_.jsx)("div",{className:"overflow-x-auto",children:"details"===k&&0===S.recent_commissions.length?(0,_.jsxs)("div",{className:"p-12 text-center",children:[(0,_.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,_.jsx)("div",{className:"w-8 h-8 border-2 border-orange-400 border-t-transparent rounded-full animate-spin"})}),(0,_.jsx)("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"Loading Commission Details..."}),(0,_.jsx)("p",{className:"text-gray-500",children:"Fetching your commission history"})]}):0===S.recent_commissions.length?(0,_.jsxs)("div",{className:"p-12 text-center",children:[(0,_.jsx)(u.A,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),(0,_.jsx)("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No Commissions Yet"}),(0,_.jsx)("p",{className:"text-gray-500",children:"Start building your network to earn affiliate commissions!"})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("table",{className:"w-full",children:[(0,_.jsx)("thead",{className:"bg-gray-800/50",children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Level"}),(0,_.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Customer"}),(0,_.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Amount"}),(0,_.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),(0,_.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Date"}),(0,_.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Note"})]})}),(0,_.jsx)("tbody",{className:"divide-y divide-gray-700/50",children:(U.length>0?U:S.recent_commissions).map(e=>{const t=(e=>{switch(e){case"credited":return{icon:x.A,color:"text-green-400",bg:"bg-green-500/20",label:"Credited"};case"pending":return{icon:g.A,color:"text-yellow-400",bg:"bg-yellow-500/20",label:"Pending"};case"failed":return{icon:w.A,color:"text-red-400",bg:"bg-red-500/20",label:"Failed"};default:return{icon:d.A,color:"text-gray-400",bg:"bg-gray-500/20",label:"Unknown"}}})(e.status),s=t.icon;return(0,_.jsxs)("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[(0,_.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,_.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-yellow-500 rounded-full flex items-center justify-center text-white font-bold text-lg mx-auto",children:e.level})}),(0,_.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"text-sm",children:[(0,_.jsx)("div",{className:"text-white font-medium",children:D[e.customer_id]||"Loading..."}),(0,_.jsx)("div",{className:"text-gray-400 text-xs mt-1",children:M[e.customer_id]||"Loading..."})]})}),(0,_.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"text-lg font-bold text-green-300",children:B(e.amount)})}),(0,_.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t.bg," ").concat(t.color," border border-current/30"),children:[(0,_.jsx)(s,{className:"w-3 h-3 mr-1"}),t.label]})}),(0,_.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(e.created_at).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,_.jsx)("td",{className:"px-6 py-4 text-sm text-gray-400 max-w-xs truncate",children:e.note||"No notes"})]},e.id)})})]}),(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-t border-gray-700/50",children:[(0,_.jsxs)("div",{className:"text-sm text-gray-400",children:["Showing ",Math.min(S.recent_commissions.length,O.limit)," of ",O.totalCount," commissions"]}),O.hasMore&&(0,_.jsxs)(c.Rq,{onClick:()=>{O.hasMore&&(async()=>{try{const t=O.page+1,s=(t-1)*O.limit,{data:r,error:a}=await m.Ay.from("affiliate_commissions").select("*").eq("recipient_id",e.id).eq("status","credited").order("created_at",{ascending:!1}).range(s,s+O.limit-1);if(a)throw new Error(a.message);const o=r.length===O.limit;if(F(e=>(0,i.A)((0,i.A)({},e),{},{page:t,hasMore:o})),E(e=>(0,i.A)((0,i.A)({},e),{},{recent_commissions:[...e.recent_commissions,...r]})),r&&r.length>0){const e=r.map(e=>e.customer_id).filter(Boolean),t=Object.keys(D),s=e.filter(e=>!t.includes(e));s.length>0&&q(s)}}catch(t){s("Failed to load more commissions. Please try again.")}})()},disabled:!O.hasMore,className:"flex items-center space-x-2",children:[(0,_.jsx)("span",{children:"Load More"}),(0,_.jsx)(p.A,{className:"w-4 h-4"})]})]})]})})]})]})})})]})}}}]);
//# sourceMappingURL=855.7c31add8.chunk.js.map