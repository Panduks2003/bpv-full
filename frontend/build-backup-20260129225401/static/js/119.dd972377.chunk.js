"use strict";(self.webpackChunkbrightplanet_ventures=self.webpackChunkbrightplanet_ventures||[]).push([[119],{974:(e,r,s)=>{s.d(r,{A:()=>i});var t=s(9379),a=s(4847);const i=class{static async createCustomer(e,r){try{const s=await fetch("".concat(a.H,"/customer/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,t.A)((0,t.A)({},e),{},{parentPromoterId:r}))}),i=await s.json();if(!s.ok||!i.success)throw new Error(i.message||"Failed to create customer");return i}catch(s){throw console.error("Customer creation error:",s),s}}static async updateCustomer(e,r){try{const s=await fetch("".concat(a.H,"/customer/update"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,t.A)({customerId:e},r))}),i=await s.json();if(!s.ok||!i.success)throw new Error(i.message||"Failed to update customer");return i}catch(s){throw console.error("Customer update error:",s),s}}static async deleteCustomer(e){try{const r=await fetch("".concat(a.H,"/customer/delete"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:e})}),s=await r.json();if(!r.ok||!s.success)throw new Error(s.message||"Failed to delete customer");return s}catch(r){throw console.error("Customer deletion error:",r),r}}static async getCustomerById(e){try{const r=await fetch("".concat(a.H,"/customer/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}),s=await r.json();if(!r.ok||!s.success)throw new Error(s.message||"Failed to get customer");return s}catch(r){throw console.error("Get customer error:",r),r}}static async getAllCustomers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const r=e?"".concat(a.H,"/customer/list?promoterId=").concat(e):"".concat(a.H,"/customer/list"),s=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}}),t=await s.json();if(!s.ok||!t.success)throw new Error(t.message||"Failed to get customers");return t}catch(r){throw console.error("Get customers error:",r),r}}}},2380:(e,r,s)=>{s.d(r,{A:()=>t});const t=(0,s(3797).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2631:(e,r,s)=>{s.d(r,{YB:()=>b});s(5043);var t=s(579);const a="rgba(247, 147, 30, 0.1)",i="rgba(255, 255, 255, 0.05)",o="\n  @keyframes bp-skeleton-shimmer {\n    0% {\n      background-position: -200px 0;\n    }\n    100% {\n      background-position: calc(200px + 100%) 0;\n    }\n  }\n  \n  .bp-skeleton-shimmer {\n    background: linear-gradient(\n      90deg,\n      ".concat(i," 25%,\n      ").concat(a," 50%,\n      ").concat(i," 75%\n    );\n    background-size: 200px 100%;\n    animation: bp-skeleton-shimmer 1.5s infinite linear;\n  }\n");if("undefined"!==typeof document&&!document.getElementById("bp-skeleton-styles")){const e=document.createElement("style");e.id="bp-skeleton-styles",e.textContent=o,document.head.appendChild(e)}const l=e=>{let{width:r="100%",height:s="1rem",className:a="",rounded:o="rounded-lg",animate:l=!0}=e;return(0,t.jsx)("div",{className:"".concat(o," border border-white/10 ").concat(l?"bp-skeleton-shimmer":""," ").concat(a),style:{width:r,height:s,background:l?void 0:i}})},d=e=>{let{className:r=""}=e;return(0,t.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-4 h-full ".concat(r),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)(l,{width:"3rem",height:"3rem",rounded:"rounded-xl"}),(0,t.jsx)(l,{width:"3rem",height:"2rem"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l,{width:"70%",height:"1rem"}),(0,t.jsx)(l,{width:"90%",height:"0.75rem"})]})]})},n=e=>{let{rows:r=5,columns:s=4,className:a=""}=e;return(0,t.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl overflow-hidden ".concat(a),children:[(0,t.jsx)("div",{className:"bg-white/5 p-4 border-b border-white/10",children:(0,t.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(".concat(s,", 1fr)")},children:Array.from({length:s}).map((e,r)=>(0,t.jsx)(l,{width:"80%",height:"1rem"},r))})}),(0,t.jsx)("div",{className:"divide-y divide-white/10",children:Array.from({length:r}).map((e,r)=>(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(".concat(s,", 1fr)")},children:Array.from({length:s}).map((e,r)=>(0,t.jsx)(l,{width:0===r?"90%":"70%",height:"1rem"},r))})},r))})]})},c=e=>{let{count:r=2,className:s=""}=e;return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-".concat(Math.min(r,4)," gap-4 ").concat(s),children:Array.from({length:r}).map((e,r)=>(0,t.jsx)(d,{},r))})},m=e=>{let{count:r=6,className:s=""}=e;return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 ".concat(s),children:Array.from({length:r}).map((e,r)=>(0,t.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l,{width:"8rem",height:"0.75rem"}),(0,t.jsx)(l,{width:"4rem",height:"2rem"})]}),(0,t.jsx)(l,{width:"3rem",height:"3rem",rounded:"rounded-xl"})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(l,{width:"60%",height:"0.75rem"})})]},r))})},h=e=>{let{className:r=""}=e;return(0,t.jsx)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-4 ".concat(r),children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(l,{width:"3rem",height:"3rem",rounded:"rounded-full"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(l,{width:"60%",height:"1rem"}),(0,t.jsx)(l,{width:"40%",height:"0.75rem"})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(l,{width:"2rem",height:"2rem",rounded:"rounded-lg"}),(0,t.jsx)(l,{width:"2rem",height:"2rem",rounded:"rounded-lg"})]})]})})},u=e=>{let{className:r="",showButton:s=!1}=e;return(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8 ".concat(r),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l,{width:"15rem",height:"2.5rem",className:"mb-2"}),(0,t.jsx)(l,{width:"20rem",height:"1rem"})]}),s&&(0,t.jsx)(l,{width:"8rem",height:"2.5rem",rounded:"rounded-lg"})]})},x=e=>{let{tabs:r=3,className:s=""}=e;return(0,t.jsx)("div",{className:"flex space-x-1 mb-8 ".concat(s),children:Array.from({length:r}).map((e,r)=>(0,t.jsx)(l,{width:"8rem",height:"3rem",rounded:"rounded-lg"},r))})},g=e=>{let{className:r=""}=e;return(0,t.jsx)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6 mb-8 ".concat(r),children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(l,{width:"100%",height:"2.5rem",rounded:"rounded-lg"})}),(0,t.jsx)("div",{className:"md:w-48",children:(0,t.jsx)(l,{width:"100%",height:"2.5rem",rounded:"rounded-lg"})})]})})},p=e=>{let{className:r=""}=e;return(0,t.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6 ".concat(r),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l,{width:"8rem",height:"1rem"}),(0,t.jsx)(l,{width:"6rem",height:"0.75rem"})]}),(0,t.jsx)(l,{width:"4rem",height:"1.5rem",rounded:"rounded-full"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(l,{width:"4rem",height:"0.75rem"}),(0,t.jsx)(l,{width:"6rem",height:"0.75rem"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(l,{width:"5rem",height:"0.75rem"}),(0,t.jsx)(l,{width:"7rem",height:"0.75rem"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-4 pt-4 border-t border-white/10",children:[(0,t.jsx)(l,{width:"4rem",height:"2rem",rounded:"rounded-lg"}),(0,t.jsx)(l,{width:"4rem",height:"2rem",rounded:"rounded-lg"})]})]})},b=e=>{let{type:r="dashboard"}=e;switch(r){case"dashboard":return(0,t.jsx)("div",{className:"min-h-screen p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)(c,{count:4}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,r)=>(0,t.jsx)(d,{},r))})]})]})});case"pin-management":return(0,t.jsx)("div",{className:"min-h-screen p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(u,{showButton:!0}),(0,t.jsx)(x,{tabs:3}),(0,t.jsx)(m,{count:6}),(0,t.jsx)(g,{}),(0,t.jsx)(n,{rows:8,columns:5})]})});case"customers":case"promoters":return(0,t.jsx)("div",{className:"min-h-screen p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(u,{showButton:!0}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"space-y-4",children:Array.from({length:8}).map((e,r)=>(0,t.jsx)(h,{},r))})]})});case"withdrawals":return(0,t.jsx)("div",{className:"min-h-screen p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(u,{}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,r)=>(0,t.jsx)(p,{},r))})]})});case"approval":return(0,t.jsx)("div",{className:"min-h-screen p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("div",{className:"mb-8 flex justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l,{width:"12rem",height:"2rem"}),(0,t.jsx)(l,{width:"20rem",height:"1rem",className:"mt-2"})]}),(0,t.jsxs)("div",{className:"flex space-x-1",children:[(0,t.jsx)(l,{width:"8rem",height:"2.5rem",rounded:"rounded-lg"}),(0,t.jsx)(l,{width:"8rem",height:"2.5rem",rounded:"rounded-lg"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-4",children:(0,t.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6 h-[calc(100vh-250px)]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)(l,{width:"8rem",height:"1.5rem"}),(0,t.jsx)(l,{width:"4rem",height:"1.5rem",rounded:"rounded-full"})]}),(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:5}).map((e,r)=>(0,t.jsxs)("div",{className:"bg-white/5 border border-slate-200/10 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)(l,{width:"10rem",height:"1rem"}),(0,t.jsx)(l,{width:"4rem",height:"0.75rem"})]}),(0,t.jsx)(l,{width:"12rem",height:"0.75rem"})]},r))})]})}),(0,t.jsx)("div",{className:"lg:col-span-8",children:(0,t.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-8",children:[(0,t.jsxs)("div",{className:"flex items-center mb-8",children:[(0,t.jsx)(l,{width:"3.5rem",height:"3.5rem",rounded:"rounded-xl"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)(l,{width:"8rem",height:"1.5rem"}),(0,t.jsx)(l,{width:"12rem",height:"0.75rem",className:"mt-1"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(l,{width:"6rem",height:"0.75rem"}),(0,t.jsxs)("div",{className:"bg-white/5 border border-slate-200/10 rounded-xl p-5 space-y-4",children:[(0,t.jsx)(l,{width:"8rem",height:"0.5rem"}),(0,t.jsx)(l,{width:"12rem",height:"1rem"}),(0,t.jsx)(l,{width:"10rem",height:"0.5rem"}),(0,t.jsx)(l,{width:"14rem",height:"1rem"})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(l,{width:"6rem",height:"0.75rem"}),(0,t.jsxs)("div",{className:"bg-white/5 border border-slate-200/10 rounded-xl p-5 space-y-4",children:[(0,t.jsx)(l,{width:"8rem",height:"0.5rem"}),(0,t.jsx)(l,{width:"10rem",height:"1rem"}),(0,t.jsx)(l,{width:"12rem",height:"1rem"}),(0,t.jsx)(l,{width:"8rem",height:"1rem"})]})]})]}),(0,t.jsxs)("div",{className:"border-t border-slate-200/10 pt-8",children:[(0,t.jsx)(l,{width:"6rem",height:"0.75rem",className:"mb-3"}),(0,t.jsx)(l,{width:"100%",height:"6rem",rounded:"rounded-xl"}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,t.jsx)(l,{width:"5rem",height:"2.5rem",rounded:"rounded-lg"}),(0,t.jsx)(l,{width:"5rem",height:"2.5rem",rounded:"rounded-lg"}),(0,t.jsx)(l,{width:"6rem",height:"2.5rem",rounded:"rounded-lg"})]})]})]})})]})]})});default:return(0,t.jsx)(b,{type:"dashboard"})}}},3395:(e,r,s)=>{s.d(r,{A:()=>t});const t=(0,s(3797).A)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},4847:(e,r,s)=>{s.d(r,{H:()=>t});const t="https://api.brightplanetventures.com/api"},4999:(e,r,s)=>{s.d(r,{A:()=>h});var t=s(9379),a=s(5043),i=(s(3792),s(987)),o=s(917),l=s(5897),d=s(1172),n=s(4009),c=s(579);const m=a.memo(e=>{let{onSubmit:r,onCancel:s,loading:m=!1,editingPromoter:h=null,availableParents:u=[],adminUsers:x=[]}=e;const[g,p]=(0,a.useState)({name:"",email:"",hasEmail:!1,password:"password123",confirmPassword:"password123",mobile:"",address:"",parentPromoter:""}),[b,j]=(0,a.useState)({}),[w,v]=(0,a.useState)(!1),[f,y]=(0,a.useState)(!1),[N,A]=(0,a.useState)({isValidating:!1,isValid:!1,message:""});(0,a.useEffect)(()=>{if(h){const e=h.email||"",r=e&&!e.includes("noemail+")&&!e.includes("@brightplanetventures.local");p({name:h.name||"",email:r?e:"",hasEmail:r,password:"password123",confirmPassword:"password123",mobile:h.mobile||h.phone||"",address:h.address||"",parentPromoter:h.parent_promoter_id||""}),A({isValidating:!1,isValid:!0,message:""}),j({})}},[h]);const k=(0,a.useMemo)(()=>[...(x||[]).map(e=>({id:e.id,label:"\ud83d\udc51 ".concat(e.name," (Admin)"),type:"admin"})),...(u||[]).map(e=>({id:e.id||e._id,label:e.isCurrentUser?"".concat(e.promoter_id||"CURRENT"," - ").concat(e.name," (You)"):"".concat(e.promoter_id||"N/A"," - ").concat(e.name||"Unknown"),type:"promoter"}))],[x,u]),C=(0,a.useCallback)(async(e,r)=>{let s=(0,t.A)({},b);switch(e){case"name":r&&r.trim()?r.trim().length<2?s.name="Name must be at least 2 characters":/^[a-zA-Z\s]+$/.test(r.trim())||(s.name="Name must contain only letters and spaces"):s.name="Name is required";break;case"email":if(g.hasEmail)if(r&&r.trim()){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.trim())||(s.email="Please enter a valid email address")}else s.email="Email address is required";break;case"password":h||(r?r.length<8?s.password="Password must be at least 8 characters":/(?=.*[a-zA-Z])(?=.*\d)/.test(r)||(s.password="Password must contain both letters and numbers"):s.password="Password is required");break;case"confirmPassword":h||r===g.password||(s.confirmPassword="Passwords do not match");break;case"mobile":if(r){const e=n.A.validateMobileFormat(r);if(e.is_valid)try{const e=await n.A.validateMobileNumber(r,(null===h||void 0===h?void 0:h.id)||null,null,"promoter");e.success&&e.is_valid||(s.mobile=e.error||"Mobile number validation failed")}catch(a){s.mobile="Mobile number validation service unavailable"}else s.mobile=e.error}else s.mobile="Mobile number is required";break;case"parentPromoter":!r&&k.length>0&&(s.parentPromoter="Parent promoter selection is required")}return j(s),s},[g,b,h]),P=(0,a.useCallback)((e,r)=>{p(s=>(0,t.A)((0,t.A)({},s),{},{[e]:r}));const s=C(e,r);j(e=>(0,t.A)((0,t.A)({},e),s)),!s[e]&&b[e]&&j(r=>{const s=(0,t.A)({},r);return delete s[e],s})},[C,b]),E=(0,a.useCallback)(async e=>{if(!e)return j(e=>(0,t.A)((0,t.A)({},e),{},{mobile:"Mobile number is required"})),void A({isValidating:!1,isValid:!1,message:""});if(h)return A({isValidating:!1,isValid:!0,message:""}),void j(e=>{const r=(0,t.A)({},e);return delete r.mobile,r});const r=n.A.validateMobileFormat(e);if(!r.is_valid)return j(e=>(0,t.A)((0,t.A)({},e),{},{mobile:r.error})),void A({isValidating:!1,isValid:!1,message:""});A({isValidating:!0,isValid:!1,message:"Validating mobile number..."}),j(e=>{const r=(0,t.A)({},e);return delete r.mobile,r});try{const r=await n.A.validateMobileNumber(e,(null===h||void 0===h?void 0:h.id)||null,null,"promoter");if(r.success&&r.is_valid)j(e=>{const r=(0,t.A)({},e);return delete r.mobile,r}),A({isValidating:!1,isValid:!0,message:""});else{const e=r.error||"Mobile number validation failed";j(r=>(0,t.A)((0,t.A)({},r),{},{mobile:e})),A({isValidating:!1,isValid:!1,message:e})}}catch(s){const e="Mobile number validation service unavailable";j(r=>(0,t.A)((0,t.A)({},r),{},{mobile:e})),A({isValidating:!1,isValid:!1,message:e})}},[h]),_=((0,a.useCallback)(e=>{const r=setTimeout(()=>{E(e)},500);return()=>clearTimeout(r)},[E]),(0,a.useCallback)(()=>{const e={};return Object.keys(g).forEach(r=>{const s=C(r,g[r]);Object.assign(e,s)}),j(e),0===Object.keys(e).length},[g,C,h])),M=(0,a.useCallback)(async e=>{if(e.preventDefault(),!_())return;const s={name:g.name,email:g.hasEmail&&g.email?g.email:null,password:g.password,mobile:g.mobile,address:g.address||null,parentPromoter:g.parentPromoter||null,useNewSystem:!0};await r(s)},[g,_,r]);return(0,c.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-700 pb-4 mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-xl font-semibold text-white",children:h?"Edit Promoter":"Create New Promoter"}),h&&(0,c.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Update promoter information and hierarchy"})]}),(0,c.jsx)("button",{type:"button",onClick:s,className:"text-gray-400 hover:text-white transition-colors",disabled:m,children:(0,c.jsx)(d.A,{className:"w-5 h-5"})})]}),(0,c.jsxs)("form",{onSubmit:M,className:"space-y-5",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Full Name",(0,c.jsx)("span",{className:"text-orange-400 ml-1",children:"*"})]}),(0,c.jsx)("input",{type:"text",value:g.name,onChange:e=>P("name",e.target.value),className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(b.name?"border-red-500":"border-gray-600"),placeholder:"Enter full name (letters and spaces only)"}),b.name&&(0,c.jsx)("p",{className:"text-red-400 text-sm mt-1",children:b.name})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center mb-2",children:[(0,c.jsx)("input",{type:"checkbox",id:"hasEmail",checked:g.hasEmail,onChange:e=>{const r=e.target.checked;p(e=>(0,t.A)((0,t.A)({},e),{},{hasEmail:r,email:r?e.email:""})),r||j(e=>{const r=(0,t.A)({},e);return delete r.email,r})},className:"mr-2 h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-600 rounded bg-gray-700"}),(0,c.jsx)("label",{htmlFor:"hasEmail",className:"text-sm font-medium text-gray-300",children:"Add Email Address"})]}),g.hasEmail&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"email",value:g.email,onChange:e=>P("email",e.target.value),className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(b.email?"border-red-500":"border-gray-600"),placeholder:"Enter email address (can be shared with others)"}),b.email&&(0,c.jsx)("p",{className:"text-red-400 text-sm mt-1",children:b.email})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Mobile Number",(0,c.jsx)("span",{className:"text-orange-400 ml-1",children:"*"})]}),(0,c.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Mobile number is mandatory and must be unique. SMS will be sent to this number."}),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("input",{type:"tel",value:g.mobile,onChange:e=>{const r=e.target.value.replace(/\D/g,"").slice(0,10);if(p(e=>(0,t.A)((0,t.A)({},e),{},{mobile:r})),A({isValidating:!1,isValid:!1,message:""}),j(e=>{const r=(0,t.A)({},e);return delete r.mobile,r}),10===r.length){const e=setTimeout(()=>{E(r)},500);return()=>clearTimeout(e)}},className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 pr-12 ".concat(b.mobile?"border-red-500":N.isValid?"border-green-500":N.isValidating?"border-blue-500":"border-gray-600"),placeholder:"Enter 10-digit mobile number",maxLength:10}),(0,c.jsxs)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:[N.isValidating&&(0,c.jsx)(l.A,{className:"w-5 h-5 text-blue-400 animate-spin"}),N.isValid&&(0,c.jsx)(o.A,{className:"w-5 h-5 text-green-400"}),b.mobile&&(0,c.jsx)(i.A,{className:"w-5 h-5 text-red-400"})]})]}),b.mobile&&(0,c.jsx)("div",{className:"mt-2 p-2 bg-red-900 border border-red-700 rounded-lg",children:(0,c.jsxs)("p",{className:"text-red-400 text-sm flex items-center",children:[(0,c.jsx)(i.A,{className:"w-4 h-4 mr-2"}),b.mobile]})}),N.isValidating&&(0,c.jsx)("div",{className:"mt-2 p-2 bg-blue-900 border border-blue-700 rounded-lg",children:(0,c.jsxs)("p",{className:"text-blue-400 text-sm flex items-center",children:[(0,c.jsx)(l.A,{className:"w-4 h-4 mr-2 animate-spin"}),N.message]})})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Address",(0,c.jsx)("span",{className:"text-gray-500 text-xs ml-2",children:"(Optional)"})]}),(0,c.jsx)("textarea",{value:g.address,onChange:e=>P("address",e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter full postal address (optional)",rows:3})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Parent Promoter",(0,c.jsx)("span",{className:"text-orange-400 ml-1",children:"*"})]}),(0,c.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Parent promoter is mandatory for hierarchy management."}),(0,c.jsxs)("select",{value:g.parentPromoter,onChange:e=>P("parentPromoter",e.target.value),disabled:1===k.length||h,className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(b.parentPromoter?"border-red-500":"border-gray-600"," ").concat(1===k.length||h?"opacity-75 cursor-not-allowed":""),children:[(0,c.jsx)("option",{value:"",disabled:!0,children:"Select parent promoter *"}),k.map(e=>(0,c.jsx)("option",{value:e.id,children:e.label},e.id))]}),b.parentPromoter&&(0,c.jsx)("p",{className:"text-red-400 text-sm mt-1",children:b.parentPromoter})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-700",children:[(0,c.jsx)("button",{type:"button",onClick:s,className:"px-6 py-3 text-gray-300 hover:text-white transition-colors",disabled:m,children:"Cancel"}),(0,c.jsx)("button",{type:"submit",disabled:m||Object.keys(b).length>0||!h&&(!g.mobile||10!==g.mobile.length||!g.parentPromoter||N.isValidating||10===g.mobile.length&&!N.isValid),className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:m?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.A,{className:"w-4 h-4 animate-spin"}),(0,c.jsx)("span",{children:h?"Updating...":"Creating..."})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.A,{className:"w-4 h-4"}),(0,c.jsx)("span",{children:h?"Update Promoter":"Create Promoter"})]})})]})]})]})});m.displayName="UnifiedPromoterForm";const h=m},5119:(e,r,s)=>{s.r(r),s.d(r,{default:()=>f});var t=s(5043),a=s(3216),i=s(6621),o=s(1921),l=s(4999),d=s(1761),n=s(3959),c=s(2631),m=s(3792),h=s(3848),u=s(974),x=s(3395),g=s(5722),p=s(6950),b=s(2380),j=s(4068),w=s(8112),v=s(579);const f=function(){const{user:e,logout:r}=(0,i.As)(),{showSuccess:s,showError:f}=(0,o.L5)(),y=(0,a.Zp)();(0,n.r9)();const[N,A]=(0,t.useState)({totalCustomers:0,totalPromoters:0,currentLevel:"Bronze",availablePins:0}),[k,C]=(0,t.useState)(!1),[P,E]=(0,t.useState)(!1),[_,M]=(0,t.useState)(0),[V,S]=(0,t.useState)(!0);(0,n.r9)();const T=(0,t.useCallback)(async()=>{const r=performance.now();try{var s,t,a;h.Ay.info("Loading dashboard data",{userId:null===e||void 0===e?void 0:e.id});const[i,o,l]=await Promise.all([m.ND.from("profiles").select("id, name, customer_id, parent_promoter_id, created_at").eq("role","customer"),m.ND.from("profiles").select("*").eq("id",null===e||void 0===e?void 0:e.id).eq("role","promoter").single(),m.ND.from("profiles").select("*").eq("role","promoter").eq("parent_promoter_id",null===e||void 0===e?void 0:e.id)]);h.Ay.debug("Dashboard data loaded",{userId:null===e||void 0===e?void 0:e.id,customersCount:(null===i||void 0===i||null===(s=i.data)||void 0===s?void 0:s.length)||0,promotersCount:(null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.length)||0,hasPromoterData:!(null===o||void 0===o||!o.data)}),i.error&&h.Ay.error("Error loading customers",{error:i.error,userId:null===e||void 0===e?void 0:e.id}),o.error&&h.Ay.error("Error loading promoter data",{error:o.error,userId:null===e||void 0===e?void 0:e.id});const d=(i.data||[]).filter(r=>(null===r||void 0===r?void 0:r.parent_promoter_id)===(null===e||void 0===e?void 0:e.id)).length,n=(null===(a=l.data)||void 0===a?void 0:a.length)||0,c=o.data,u=(null===c||void 0===c?void 0:c.business_category)||"Bronze",x=(null===c||void 0===c?void 0:c.pins)||0;A({totalCustomers:d,totalPromoters:n,currentLevel:u,availablePins:x}),M(x);const g=performance.now();h.Ay.performance("Dashboard data load",g-r),h.Ay.dataLoad("Dashboard",d+n,g-r)}catch(i){h.Ay.error("Error loading dashboard data",{error:i.message,userId:null===e||void 0===e?void 0:e.id}),f("Failed to load dashboard data. Please refresh the page.")}finally{S(!1)}},[null===e||void 0===e?void 0:e.id]);(0,t.useEffect)(()=>{null!==e&&void 0!==e&&e.id&&T()},[e,T]);const q=[{title:"Total Customers",value:N.totalCustomers,description:"Active customers",icon:w.A,color:"from-blue-500 to-blue-600",route:"/promoter/my-customers"},{title:"My Promoters",value:N.totalPromoters,description:"Direct promoters",icon:x.A,color:"from-purple-500 to-purple-600",route:"/promoter/my-promoters"},{title:"Available Pins",value:_,description:V?"Loading...":0===_?"No pins available":"Ready to use",icon:p.A,color:_>0?"from-orange-500 to-orange-600":"from-red-500 to-red-600",route:"/promoter/pin-management"}];return V?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.wE,{}),(0,v.jsx)(n.dQ,{children:(0,v.jsx)(c.YB,{type:"dashboard"})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.wE,{}),(0,v.jsxs)(n.dQ,{children:[(0,v.jsx)("div",{children:(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 via-transparent to-yellow-500/5"}),(0,v.jsxs)("div",{className:"relative max-w-6xl mx-auto px-6 pt-40 pb-12",children:[(0,v.jsxs)("div",{className:"text-center mb-6","data-animate":!0,children:[(0,v.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-2",children:[(0,v.jsxs)("h1",{className:"text-3xl md:text-4xl font-bold text-white",children:["Welcome, ",(0,v.jsx)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-yellow-400",children:(null===e||void 0===e?void 0:e.name)||"Promoter"})]}),(0,v.jsx)(n.Rq,{onClick:T,variant:"secondary",className:"p-2",title:"Refresh dashboard data",children:(0,v.jsx)(j.A,{className:"w-5 h-5"})})]}),(0,v.jsx)("p",{className:"text-slate-400 mb-6",children:"Manage your network and grow your business"}),(0,v.jsx)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:(0,v.jsxs)(n.Rq,{onClick:()=>{E(!0)},disabled:_<=0,variant:_<=0?"secondary":"primary",className:"w-full sm:w-auto flex items-center justify-center space-x-2",title:_<=0?"No pins available - Request pins from admin":"Create New Customer (".concat(_," pins available)"),children:[(0,v.jsx)(b.A,{className:"w-5 h-5"}),(0,v.jsx)("span",{children:"Create Customer"}),_>0&&(0,v.jsxs)("span",{className:"ml-2 bg-white/20 px-2 py-0.5 rounded-full text-xs",children:[_," pins"]})]})})]}),(0,v.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:q.map((e,r)=>{const s=e.icon;return(0,v.jsx)(n.Xg,{className:"group relative overflow-hidden p-6 cursor-pointer hover:scale-[1.02] transition-all duration-300 border border-slate-700/50 hover:border-orange-400/50 bg-gradient-to-br from-slate-800/90 to-slate-900/90",onClick:()=>{return r=e.route,void y(r);var r},children:(0,v.jsxs)("div",{className:"relative flex items-center space-x-4",children:[(0,v.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r ".concat(e.color," rounded-lg flex items-center justify-center shadow-lg"),children:(0,v.jsx)(s,{className:"w-6 h-6 text-white"})}),(0,v.jsxs)("div",{className:"flex-1",children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-white mb-1",children:e.title}),(0,v.jsx)("p",{className:"text-2xl font-bold text-white",children:e.value}),(0,v.jsx)("p",{className:"text-slate-400 text-sm",children:e.description})]})]})},r)})}),(0,v.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,v.jsx)("div",{className:"group cursor-pointer hover:scale-105 transition-all duration-300 border border-slate-700/50 hover:border-blue-400/50 bg-gradient-to-br from-slate-800/90 to-slate-900/90 p-4 rounded-xl",onClick:()=>y("/promoter/my-customers"),children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,v.jsx)(w.A,{className:"w-6 h-6 text-white"})}),(0,v.jsx)("h3",{className:"text-sm font-semibold text-white mb-1",children:"My Customers"}),(0,v.jsx)("p",{className:"text-slate-400 text-xs",children:"Manage customers"})]})}),(0,v.jsx)("div",{className:"group cursor-pointer hover:scale-105 transition-all duration-300 border border-slate-700/50 hover:border-purple-400/50 bg-gradient-to-br from-slate-800/90 to-slate-900/90 p-4 rounded-xl",onClick:()=>y("/promoter/my-promoters"),children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,v.jsx)(x.A,{className:"w-6 h-6 text-white"})}),(0,v.jsx)("h3",{className:"text-sm font-semibold text-white mb-1",children:"My Promoters"}),(0,v.jsx)("p",{className:"text-slate-400 text-xs",children:"View network"})]})}),(0,v.jsx)("div",{className:"group cursor-pointer hover:scale-105 transition-all duration-300 border border-slate-700/50 hover:border-orange-400/50 bg-gradient-to-br from-slate-800/90 to-slate-900/90 p-4 rounded-xl",onClick:()=>y("/promoter/pin-management"),children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r ".concat(_>0?"from-orange-500 to-orange-600":"from-red-500 to-red-600"," rounded-lg flex items-center justify-center mx-auto mb-3"),children:(0,v.jsx)(p.A,{className:"w-6 h-6 text-white"})}),(0,v.jsx)("h3",{className:"text-sm font-semibold text-white mb-1",children:"Pin Management"}),(0,v.jsx)("p",{className:"text-slate-400 text-xs",children:"Manage pins"})]})}),(0,v.jsx)("div",{className:"group cursor-pointer hover:scale-105 transition-all duration-300 border border-slate-700/50 hover:border-green-400/50 bg-gradient-to-br from-slate-800/90 to-slate-900/90 p-4 rounded-xl",onClick:()=>y("/promoter/withdrawal-request"),children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,v.jsx)(g.A,{className:"w-6 h-6 text-white"})}),(0,v.jsx)("h3",{className:"text-sm font-semibold text-white mb-1",children:"Withdrawals"}),(0,v.jsx)("p",{className:"text-slate-400 text-xs",children:"Request withdrawal"})]})})]})]})]})}),k&&(0,v.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,v.jsx)(l.A,{isOpen:k,onClose:()=>C(!1),onSubmit:async r=>{try{if(!r.name||""===r.name.trim())throw new Error("Name is required for promoter creation.");if(!r.password||""===r.password.trim())throw new Error("Password is required for promoter creation.");if(!r.phone||""===r.phone.trim())throw new Error("Phone number is required for promoter creation.");const i=Date.now(),o=Math.floor(1e6*Math.random());let l,d,n="promo".concat(i).concat(o,"@brightplanet.com");try{const e="https://api.brightplanetventures.com/api",s=await fetch("".concat(e,"/create-promoter-auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r.password,userData:{role:"promoter",name:r.name,phone:r.phone}})});if(!s.ok)throw new Error("Backend service not available");l={user:(await s.json()).user}}catch(a){throw new Error("Backend service not available. Please ensure the backend API is running to safely create promoter auth without changing your session.")}if(d){var t;if(null!==(t=d.message)&&void 0!==t&&t.includes("already registered"))throw new Error("Email ".concat(n," is already registered. Please try again."));throw new Error("Failed to create auth user: "+d.message)}if(!l.user)throw new Error("Failed to create auth user: No user data returned");const{error:c}=await m.ND.rpc("confirm_promoter_email",{p_user_id:l.user.id}),{data:h,error:u}=await m.ND.rpc("create_promoter_with_auth_id",{p_name:r.name.trim(),p_user_id:l.user.id,p_auth_email:n,p_password:r.password.trim(),p_phone:r.phone.trim(),p_email:r.email&&r.email.trim()?r.email.trim():null,p_address:r.address&&r.address.trim()?r.address.trim():null,p_parent_promoter_id:e.id,p_role_level:"Affiliate",p_status:"Active"});if(u)throw u;if(!h||!h.success)throw new Error((null===h||void 0===h?void 0:h.error)||"Failed to create promoter profile");s("Promoter created successfully and is ready to use.\n\nPromoter ID: ".concat(h.promoter_id,"\nName: ").concat(h.name,"\nLogin: Use Promoter ID + Password")),await T(),C(!1)}catch(i){f("Failed to create promoter: ".concat(i.message))}},promoters:[{id:e.id,name:e.name||"Current Promoter",promoter_id:e.promoter_id||"CURRENT",isCurrentUser:!0}],adminUsers:[]})}),(0,v.jsx)(d.A,{isOpen:P,onClose:()=>E(!1),onSubmit:async r=>{try{if(_<1)throw new Error("Insufficient pins to create customer. You need 1 pin but only have ".concat(_," pins available. Please request more pins from admin."));const t=await u.A.createCustomer(r,null===e||void 0===e?void 0:e.id);if(!t.success)throw new Error(t.error||t.message||"Failed to create customer");s(t.message||"Customer created successfully and is ready to use.\n\nCustomer ID: ".concat(r.cardNo,"\nName: ").concat(r.name,"\nLogin: Use Customer ID + Password")),await T(),setTimeout(async()=>{await T()},1e3),E(!1)}catch(t){f("Failed to create customer: ".concat(t.message))}},promoters:[{id:null===e||void 0===e?void 0:e.id,name:(null===e||void 0===e?void 0:e.name)||"Current Promoter",promoter_id:(null===e||void 0===e?void 0:e.promoter_id)||"CURRENT",role:"promoter"}],isEditing:!1,initialData:{parentPromoter:null===e||void 0===e?void 0:e.id}})]})]})}},5722:(e,r,s)=>{s.d(r,{A:()=>t});const t=(0,s(3797).A)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},6950:(e,r,s)=>{s.d(r,{A:()=>t});const t=(0,s(3797).A)("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]])},8112:(e,r,s)=>{s.d(r,{A:()=>t});const t=(0,s(3797).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}}]);
//# sourceMappingURL=119.dd972377.chunk.js.map