{"version":3,"file":"static/js/660.c3b53e9c.chunk.js","mappings":"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","sources":["../node_modules/lucide-react/src/icons/file-text.ts","services/pinRequestService.js","../node_modules/lucide-react/src/icons/send.ts","../node_modules/lucide-react/src/icons/x-circle.ts","services/pinTransactionService.js","../node_modules/lucide-react/src/icons/pin.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name FileText\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQuNSAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWNy41TDE0LjUgMnoiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTQgMiAxNCA4IDIwIDgiIC8+CiAgPGxpbmUgeDE9IjE2IiB4Mj0iOCIgeTE9IjEzIiB5Mj0iMTMiIC8+CiAgPGxpbmUgeDE9IjE2IiB4Mj0iOCIgeTE9IjE3IiB5Mj0iMTciIC8+CiAgPGxpbmUgeDE9IjEwIiB4Mj0iOCIgeTE9IjkiIHkyPSI5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/file-text\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FileText = createLucideIcon('FileText', [\n  [\n    'path',\n    {\n      d: 'M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z',\n      key: '1nnpy2',\n    },\n  ],\n  ['polyline', { points: '14 2 14 8 20 8', key: '1ew0cm' }],\n  ['line', { x1: '16', x2: '8', y1: '13', y2: '13', key: '14keom' }],\n  ['line', { x1: '16', x2: '8', y1: '17', y2: '17', key: '17nazh' }],\n  ['line', { x1: '10', x2: '8', y1: '9', y2: '9', key: '1a5vjj' }],\n]);\n\nexport default FileText;\n","/**\n * PIN REQUEST SERVICE\n * ===================\n * Service for handling PIN request and approval workflow\n */\n\nimport { supabase } from '../common/services/supabaseClient';\nimport pinTransactionService from './pinTransactionService';\n\n// =====================================================\n// CONSTANTS\n// =====================================================\n\nexport const PIN_REQUEST_STATUS = {\n  PENDING: 'pending',\n  APPROVED: 'approved',\n  REJECTED: 'rejected'\n};\n\nexport const PIN_REQUEST_CONFIG = {\n  [PIN_REQUEST_STATUS.PENDING]: {\n    emoji: 'ðŸŸ¡',\n    label: 'Pending',\n    color: 'yellow',\n    description: 'Waiting for admin approval'\n  },\n  [PIN_REQUEST_STATUS.APPROVED]: {\n    emoji: 'ðŸŸ¢',\n    label: 'Approved',\n    color: 'green',\n    description: 'PINs allocated successfully'\n  },\n  [PIN_REQUEST_STATUS.REJECTED]: {\n    emoji: 'ðŸ”´',\n    label: 'Rejected',\n    color: 'red',\n    description: 'Request declined by admin'\n  }\n};\n\n// =====================================================\n// PIN REQUEST FUNCTIONS\n// =====================================================\n\n/**\n * Submit a new PIN request\n */\nexport const submitPinRequest = async (promoterId, requestedPins, reason = null) => {\n  try {\n    const { data, error } = await supabase.rpc('submit_pin_request', {\n      p_promoter_id: promoterId,\n      p_requested_pins: requestedPins,\n      p_reason: reason\n    });\n\n    if (error) {\n      // Check if it's a missing function error, try direct table insert\n      if (error.code === '42883' || error.code === 'PGRST202') {\n        console.warn('submit_pin_request function not found. Using direct table insert.');\n        \n        // Validate input first\n        if (!requestedPins || requestedPins <= 0 || requestedPins > 1000) {\n          throw new Error('Requested PINs must be between 1 and 1000');\n        }\n\n        // Check for pending requests\n        const { data: pendingCheck } = await supabase\n          .from('pin_requests')\n          .select('id')\n          .eq('promoter_id', promoterId)\n          .eq('status', 'pending');\n\n        if (pendingCheck && pendingCheck.length > 0) {\n          throw new Error('You already have a pending PIN request. Please wait for admin approval.');\n        }\n\n        // Insert directly into table (using existing schema)\n        const { data: insertData, error: insertError } = await supabase\n          .from('pin_requests')\n          .insert({\n            promoter_id: promoterId,\n            quantity: requestedPins, // Use 'quantity' instead of 'requested_pins'\n            reason: reason || 'PIN request submitted', // Ensure reason is never null\n            category: 'standard', // Required field\n            urgency: 'normal' // Required field\n          })\n          .select('*')\n          .single();\n\n        if (insertError) throw insertError;\n\n        return {\n          success: true,\n          request_id: insertData.id,\n          request_number: insertData.request_id, // Use existing 'request_id' field\n          message: 'PIN request submitted successfully'\n        };\n      }\n      \n      // Check if it's a missing function error\n      if (error.message?.includes('does not exist')) {\n        throw new Error('PIN request system is not set up. Please contact administrator to run the database setup.');\n      }\n      console.error('âŒ PIN request submission failed:', error);\n      throw error;\n    }\n\n    if (!data.success) {\n      console.error('âŒ PIN request returned error:', data.error);\n      throw new Error(data.error || 'PIN request submission failed');\n    }\n\n    return data;\n\n  } catch (error) {\n    console.error('âŒ PIN request service error:', error);\n    throw error;\n  }\n};\n\n/**\n * Get PIN requests for a promoter or all requests (admin)\n */\nexport const getPinRequests = async (promoterId = null, status = null, limit = 50) => {\n  try {\n    // First try to check if table exists by querying it directly\n    const { data: tableCheck, error: tableError } = await supabase\n      .from('pin_requests')\n      .select('id')\n      .limit(1);\n\n    // If table doesn't exist or RLS is blocking, return empty array\n    if (tableError && (tableError.code === '42P01' || tableError.code === '42703' || tableError.code === 'PGRST106' || tableError.code === 'PGRST301')) {\n      console.warn('PIN requests table not found or RLS policies blocking access. Please run the database setup script.');\n      return [];\n    }\n\n    // If table exists, use the RPC function\n    const { data, error } = await supabase.rpc('get_pin_requests', {\n      p_promoter_id: promoterId,\n      p_status: status,\n      p_limit: limit\n    });\n\n    if (error) {\n      // Check if it's a missing function error, fallback to direct query\n      if (error.code === '42883' || error.code === 'PGRST202') {\n        console.warn('get_pin_requests function not found. Using direct table query.');\n        \n        // Use simple query without complex joins to avoid relationship issues\n        console.warn('Using simple query without joins to avoid relationship issues.');\n        \n        let simpleQuery = supabase\n          .from('pin_requests')\n          .select('*')\n          .order('created_at', { ascending: false })\n          .limit(limit);\n\n        if (promoterId) {\n          simpleQuery = simpleQuery.eq('promoter_id', promoterId);\n        }\n        if (status) {\n          simpleQuery = simpleQuery.eq('status', status);\n        }\n\n        const { data: directData, error: directError } = await simpleQuery;\n        \n        if (directError) {\n          // If table doesn't exist or RLS is blocking, return empty array\n          if (directError.code === '42P01' || directError.code === 'PGRST200' || directError.code === 'PGRST301') {\n            console.warn('pin_requests table not found, relationships missing, or RLS blocking access. Returning empty array.');\n            return [];\n          }\n          throw directError;\n        }\n\n        // Transform the data to match expected format (map existing schema)\n        return directData.map(request => ({\n          ...request,\n          // Map existing schema to expected format\n          requested_pins: request.quantity, // Map quantity to requested_pins\n          request_number: request.request_id, // Map request_id to request_number\n          approved_by: request.processed_by, // Map processed_by to approved_by\n          approved_at: request.response_date, // Map response_date to approved_at\n          \n          promoter_name: 'Promoter', // Will be filled by separate query if needed\n          promoter_email: 'promoter@example.com', // Will be filled by separate query if needed\n          admin_name: null, // Will be filled by separate query if needed\n          statusConfig: PIN_REQUEST_CONFIG[request.status] || {\n            emoji: 'â“',\n            label: 'Unknown',\n            color: 'gray',\n            description: 'Unknown status'\n          },\n          formattedRequestNumber: request.formatted_request_id || `REQ-${String(request.request_id || request.request_number).padStart(3, '0')}`,\n          formattedDate: new Date(request.created_at).toLocaleDateString(),\n          formattedTime: new Date(request.created_at).toLocaleTimeString([], { \n            hour: '2-digit', \n            minute: '2-digit' \n          })\n        }));\n      }\n      \n      // Check if it's a missing table/function error\n      if (error.message?.includes('does not exist') || error.code === '42703') {\n        console.warn('PIN requests table/function not found. Returning empty array.');\n        return [];\n      }\n      throw error;\n    }\n\n    // Transform data for UI display\n    const transformedData = data.map(request => ({\n      ...request,\n      statusConfig: PIN_REQUEST_CONFIG[request.status] || {\n        emoji: 'â“',\n        label: 'Unknown',\n        color: 'gray',\n        description: 'Unknown status'\n      },\n      formattedRequestNumber: request.formatted_request_id || `REQ-${String(request.request_number).padStart(3, '0')}`,\n      formattedDate: new Date(request.created_at).toLocaleDateString(),\n      formattedTime: new Date(request.created_at).toLocaleTimeString([], { \n        hour: '2-digit', \n        minute: '2-digit' \n      })\n    }));\n\n    return transformedData;\n\n  } catch (error) {\n    console.error('âŒ Failed to get PIN requests:', error);\n    throw error;\n  }\n};\n\n/**\n * Approve a PIN request (Admin only)\n */\nexport const approvePinRequest = async (requestId, adminId, adminNotes = null) => {\n  try {\n    const { data, error } = await supabase.rpc('approve_pin_request', {\n      p_request_id: requestId,\n      p_admin_id: adminId,\n      p_admin_notes: adminNotes\n    });\n\n    if (error) {\n      // If RPC function doesn't exist, use manual approval process\n      if (error.code === '42883' || error.code === 'PGRST202') {\n        console.warn('approve_pin_request function not found. Using manual approval process.');\n        return await manualApproveRequest(requestId, adminId, adminNotes);\n      }\n      console.error('âŒ PIN request approval failed:', error);\n      throw error;\n    }\n\n    if (!data.success) {\n      console.error('âŒ PIN request approval returned error:', data.error);\n      throw new Error(data.error || 'PIN request approval failed');\n    }\n\n    return data;\n\n  } catch (error) {\n    console.error('âŒ PIN request approval service error:', error);\n    throw error;\n  }\n};\n\n/**\n * Manual approval process when RPC function is not available\n */\nconst manualApproveRequest = async (requestId, adminId, adminNotes) => {\n  // Get the request details\n  const { data: request, error: requestError } = await supabase\n    .from('pin_requests')\n    .select('*')\n    .eq('id', requestId)\n    .eq('status', 'pending')\n    .single();\n\n  if (requestError || !request) {\n    throw new Error('Request not found or already processed');\n  }\n\n  // Use the unified PIN transaction service to allocate PINs\n  const pinResult = await pinTransactionService.adminAllocatePins(\n    request.promoter_id,\n    request.quantity || request.requested_pins, // Use quantity (existing schema) or requested_pins\n    adminId\n  );\n\n  if (!pinResult.success) {\n    throw new Error(`Failed to allocate PINs: ${pinResult.error}`);\n  }\n\n  // Update the request status (using existing schema)\n  const { error: updateError } = await supabase\n    .from('pin_requests')\n    .update({\n      status: 'approved',\n      processed_by: adminId, // Use existing field name\n      admin_notes: adminNotes,\n      response_date: new Date().toISOString() // Use existing field name\n    })\n    .eq('id', requestId);\n\n  if (updateError) {\n    throw new Error(`Failed to update request status: ${updateError.message}`);\n  }\n\n  return {\n    success: true,\n    request_id: requestId,\n    promoter_id: request.promoter_id,\n    allocated_pins: request.requested_pins,\n    new_balance: pinResult.balance_after,\n    message: 'PIN request approved and PINs allocated successfully'\n  };\n};\n\n/**\n * Reject a PIN request (Admin only)\n */\nexport const rejectPinRequest = async (requestId, adminId, adminNotes = null) => {\n  try {\n    const { data, error } = await supabase.rpc('reject_pin_request', {\n      p_request_id: requestId,\n      p_admin_id: adminId,\n      p_admin_notes: adminNotes\n    });\n\n    if (error) {\n      // If RPC function doesn't exist, use manual rejection process\n      if (error.code === '42883' || error.code === 'PGRST202') {\n        console.warn('reject_pin_request function not found. Using manual rejection process.');\n        return await manualRejectRequest(requestId, adminId, adminNotes);\n      }\n      console.error('âŒ PIN request rejection failed:', error);\n      throw error;\n    }\n\n    if (!data.success) {\n      console.error('âŒ PIN request rejection returned error:', data.error);\n      throw new Error(data.error || 'PIN request rejection failed');\n    }\n\n    return data;\n\n  } catch (error) {\n    console.error('âŒ PIN request rejection service error:', error);\n    throw error;\n  }\n};\n\n/**\n * Manual rejection process when RPC function is not available\n */\nconst manualRejectRequest = async (requestId, adminId, adminNotes) => {\n  // Get the request details\n  const { data: request, error: requestError } = await supabase\n    .from('pin_requests')\n    .select('*')\n    .eq('id', requestId)\n    .eq('status', 'pending')\n    .single();\n\n  if (requestError || !request) {\n    throw new Error('Request not found or already processed');\n  }\n\n  // Update the request status (using existing schema)\n  const { error: updateError } = await supabase\n    .from('pin_requests')\n    .update({\n      status: 'rejected',\n      processed_by: adminId, // Use existing field name\n      admin_notes: adminNotes || 'Request rejected by admin',\n      response_date: new Date().toISOString() // Use existing field name\n    })\n    .eq('id', requestId);\n\n  if (updateError) {\n    throw new Error(`Failed to update request status: ${updateError.message}`);\n  }\n\n  return {\n    success: true,\n    request_id: requestId,\n    promoter_id: request.promoter_id,\n    message: 'PIN request rejected'\n  };\n};\n\n/**\n * Get PIN request statistics\n */\nexport const getPinRequestStats = async (promoterId = null) => {\n  try {\n    const requests = await getPinRequests(promoterId);\n    \n    const stats = {\n      totalRequests: requests.length,\n      pendingRequests: requests.filter(r => r.status === PIN_REQUEST_STATUS.PENDING).length,\n      approvedRequests: requests.filter(r => r.status === PIN_REQUEST_STATUS.APPROVED).length,\n      rejectedRequests: requests.filter(r => r.status === PIN_REQUEST_STATUS.REJECTED).length,\n      totalPinsRequested: requests.reduce((sum, r) => sum + r.requested_pins, 0),\n      totalPinsApproved: requests\n        .filter(r => r.status === PIN_REQUEST_STATUS.APPROVED)\n        .reduce((sum, r) => sum + r.requested_pins, 0)\n    };\n\n    return stats;\n\n  } catch (error) {\n    console.error('âŒ Failed to get PIN request stats:', error);\n    // Return empty stats if system is not set up yet\n    return {\n      totalRequests: 0,\n      pendingRequests: 0,\n      approvedRequests: 0,\n      rejectedRequests: 0,\n      totalPinsRequested: 0,\n      totalPinsApproved: 0\n    };\n  }\n};\n\n/**\n * Check if promoter has pending requests\n */\nexport const hasPendingRequests = async (promoterId) => {\n  try {\n    const pendingRequests = await getPinRequests(promoterId, PIN_REQUEST_STATUS.PENDING, 1);\n    return pendingRequests.length > 0;\n  } catch (error) {\n    console.error('âŒ Failed to check pending requests:', error);\n    // Return false if system is not set up yet\n    return false;\n  }\n};\n\n/**\n * Real-time PIN requests subscription\n */\nexport const subscribeToPinRequests = (callback, promoterId = null) => {\n  let filter = '';\n  if (promoterId) {\n    filter = `promoter_id=eq.${promoterId}`;\n  }\n\n  const subscription = supabase\n    .channel('pin-requests-changes')\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'pin_requests',\n        filter: filter\n      },\n      (payload) => {\n        callback(payload);\n      }\n    )\n    .subscribe();\n\n  return subscription;\n};\n\n/**\n * Format PIN request for display\n */\nexport const formatPinRequest = (request) => {\n  return {\n    ...request,\n    displayTitle: `${request.formattedRequestNumber} - ${request.requested_pins} PIN${request.requested_pins > 1 ? 's' : ''}`,\n    displayStatus: `${request.statusConfig.emoji} ${request.statusConfig.label}`,\n    displayDate: `${request.formattedDate} at ${request.formattedTime}`,\n    displayReason: request.reason || 'No reason provided'\n  };\n};\n\n/**\n * Validate PIN request input\n */\nexport const validatePinRequest = (requestedPins, reason = '') => {\n  const errors = [];\n\n  if (!requestedPins || requestedPins <= 0) {\n    errors.push('Requested PINs must be greater than 0');\n  }\n\n  if (requestedPins > 1000) {\n    errors.push('Cannot request more than 1000 PINs at once');\n  }\n\n  if (reason && reason.length > 500) {\n    errors.push('Reason must be less than 500 characters');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\nexport default {\n  submitPinRequest,\n  getPinRequests,\n  approvePinRequest,\n  rejectPinRequest,\n  getPinRequestStats,\n  hasPendingRequests,\n  subscribeToPinRequests,\n  formatPinRequest,\n  validatePinRequest,\n  PIN_REQUEST_STATUS,\n  PIN_REQUEST_CONFIG\n};\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Send\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjIgMi03IDIwLTQtOS05LTRaIiAvPgogIDxwYXRoIGQ9Ik0yMiAyIDExIDEzIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/send\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Send = createLucideIcon('Send', [\n  ['path', { d: 'm22 2-7 20-4-9-9-4Z', key: '1q3vgg' }],\n  ['path', { d: 'M22 2 11 13', key: 'nzbqef' }],\n]);\n\nexport default Send;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name XCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJtMTUgOS02IDYiIC8+CiAgPHBhdGggZD0ibTkgOSA2IDYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/x-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst XCircle = createLucideIcon('XCircle', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'm15 9-6 6', key: '1uzhvr' }],\n  ['path', { d: 'm9 9 6 6', key: 'z0biqf' }],\n]);\n\nexport default XCircle;\n","/**\n * UNIFIED PIN TRANSACTION SERVICE\n * ================================\n * Centralized service for all PIN operations across Admin, Promoter, and Customer systems\n * Ensures complete uniformity and standardization\n */\n\nimport { supabase } from '../common/services/supabaseClient';\n\n// =====================================================\n// CONSTANTS - Standardized Action Types\n// =====================================================\n\nexport const PIN_ACTION_TYPES = {\n  CUSTOMER_CREATION: 'customer_creation',    // âŒ Customer Creation (- PIN)\n  ADMIN_ALLOCATION: 'admin_allocation',      // âœ… Admin Allocation (+ PIN)\n  ADMIN_DEDUCTION: 'admin_deduction'         // âŒ Admin Deduction (- PIN)\n};\n\nexport const PIN_DISPLAY_CONFIG = {\n  [PIN_ACTION_TYPES.CUSTOMER_CREATION]: {\n    emoji: 'âŒ',\n    label: 'Customer Creation',\n    color: 'red',\n    sign: '-'\n  },\n  [PIN_ACTION_TYPES.ADMIN_ALLOCATION]: {\n    emoji: 'âœ…',\n    label: 'Admin Allocation',\n    color: 'green',\n    sign: '+'\n  },\n  [PIN_ACTION_TYPES.ADMIN_DEDUCTION]: {\n    emoji: 'âŒ',\n    label: 'Admin Deduction',\n    color: 'red',\n    sign: '-'\n  }\n};\n\n// =====================================================\n// CORE PIN TRANSACTION FUNCTIONS\n// =====================================================\n\n/**\n * Execute a PIN transaction using the unified system\n */\nexport const executePinTransaction = async ({\n  userId,\n  actionType,\n  pinChangeValue,\n  createdBy = null,\n  relatedEntityId = null,\n  relatedEntityName = null\n}) => {\n  try {\n    const { data, error } = await supabase.rpc('execute_pin_transaction', {\n      p_user_id: userId,\n      p_action_type: actionType,\n      p_pin_change_value: pinChangeValue,\n      p_created_by: createdBy,\n      p_related_entity_id: relatedEntityId,\n      p_related_entity_name: relatedEntityName\n    });\n\n    if (error) {\n      throw error;\n    }\n\n    if (!data.success) {\n      throw new Error(data.error || 'PIN transaction failed');\n    }\n\n    return data;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n * Deduct PIN for customer creation\n */\nexport const deductPinForCustomerCreation = async (promoterId, customerId, customerName) => {\n  try {\n    const { data, error } = await supabase.rpc('deduct_pin_for_customer_creation', {\n      p_promoter_id: promoterId,\n      p_customer_id: customerId,\n      p_customer_name: customerName\n    });\n\n    if (error) throw error;\n    if (!data.success) throw new Error(data.error || 'Customer creation PIN deduction failed');\n\n    return data;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n * Admin allocate PINs to user\n */\nexport const adminAllocatePins = async (targetUserId, pinAmount, adminId) => {\n  try {\n    const { data, error } = await supabase.rpc('admin_allocate_pins', {\n      p_target_user_id: targetUserId,\n      p_pin_amount: Math.abs(pinAmount), // Ensure positive\n      p_admin_id: adminId\n    });\n\n    if (error) throw error;\n    if (!data.success) throw new Error(data.error || 'Admin PIN allocation failed');\n\n    return data;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n * Admin deduct PINs from user\n */\nexport const adminDeductPins = async (targetUserId, pinAmount, adminId) => {\n  try {\n    const { data, error } = await supabase.rpc('admin_deduct_pins', {\n      p_target_user_id: targetUserId,\n      p_pin_amount: Math.abs(pinAmount), // Ensure positive (function will make it negative)\n      p_admin_id: adminId\n    });\n\n    if (error) throw error;\n    if (!data.success) throw new Error(data.error || 'Admin PIN deduction failed');\n\n    return data;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n// =====================================================\n// PIN TRANSACTION QUERIES\n// =====================================================\n\n/**\n * Get PIN transactions for a user\n */\nexport const getUserPinTransactions = async (userId, limit = 50) => {\n  try {\n    let { data, error } = await supabase\n      .from('pin_transactions')\n      .select(`\n        id,\n        transaction_id,\n        action_type,\n        pin_change_value,\n        balance_before,\n        balance_after,\n        note,\n        created_at,\n        created_by,\n        related_entity_id,\n        creator:profiles!created_by(name, email)\n      `)\n      .eq('user_id', userId)\n      .order('created_at', { ascending: false })\n      .limit(limit);\n\n    if (error) throw error;\n\n    // If no transactions found with user_id, try with promoter_id as a fallback for legacy data\n    if (data.length === 0) {\n      const { data: fallbackData, error: fallbackError } = await supabase\n        .from('pin_transactions')\n        .select(`\n          id,\n          transaction_id,\n          action_type,\n          pin_change_value,\n          balance_before,\n          balance_after,\n          note,\n          created_at,\n          created_by,\n          related_entity_id,\n          creator:profiles!created_by(name, email)\n        `)\n        .eq('promoter_id', userId) // Fallback to promoter_id\n        .order('created_at', { ascending: false })\n        .limit(limit);\n\n      if (fallbackError) throw fallbackError;\n      data = fallbackData;\n    }\n\n    // Transform data for UI display\n    const transformedData = data.map(transaction => ({\n      ...transaction,\n      displayConfig: PIN_DISPLAY_CONFIG[transaction.action_type] || {\n        emoji: 'â“',\n        label: 'Unknown',\n        color: 'gray',\n        sign: ''\n      },\n      formattedAmount: formatPinAmount(transaction.action_type, transaction.pin_change_value),\n      creatorName: transaction.creator?.name || 'System'\n    }));\n\n    return transformedData;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n * Get all PIN transactions (Admin view)\n */\nexport const getAllPinTransactions = async (filters = {}, limit = 100) => {\n  try {\n    let query = supabase\n      .from('pin_transactions')\n      .select(`\n        id,\n        transaction_id,\n        user_id,\n        action_type,\n        pin_change_value,\n        balance_before,\n        balance_after,\n        note,\n        created_at,\n        created_by,\n        related_entity_id,\n        user:profiles!user_id(id, name, email, role, promoter_id),\n        creator:profiles!created_by(id, name, email)\n      `)\n      .order('created_at', { ascending: false })\n      .limit(limit);\n\n    // Apply filters\n    if (filters.actionType && filters.actionType !== 'all') {\n      query = query.eq('action_type', filters.actionType);\n    }\n\n    if (filters.userId) {\n      query = query.eq('user_id', filters.userId);\n    }\n\n    if (filters.dateFrom) {\n      query = query.gte('created_at', filters.dateFrom);\n    }\n\n    if (filters.dateTo) {\n      query = query.lte('created_at', filters.dateTo);\n    }\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw error;\n    }\n\n    // Log transactions with missing user data\n    const missingUser = data.filter(t => !t.user || !t.user.name);\n\n    // Fetch all profiles separately to use as fallback for missing joins\n    // This ensures we can find user details even if the join fails\n    let profilesMap = new Map();\n    let customersMap = new Map(); // Map customer_id -> customer profile (for finding parent_promoter_id)\n    let pinUsageLogMap = new Map(); // Map transaction_id -> pin_usage_log entry (for finding promoter_id)\n    \n    try {\n      const { data: profilesData, error: profilesError } = await supabase\n        .from('profiles')\n        .select('id, name, email, role, promoter_id, parent_promoter_id, created_at')\n        .in('role', ['promoter', 'admin', 'customer']); // Include all roles to catch any user\n      \n      if (!profilesError && profilesData) {\n        profilesData.forEach(p => {\n          profilesMap.set(p.id, p);\n          // Also map customers by their id for lookup via related_entity_id\n          if (p.role === 'customer') {\n            customersMap.set(p.id, p);\n          }\n        });\n      } else if (profilesError) {\n        // Error loading profiles - silent\n      }\n    } catch (err) {\n      // Could not load profiles - silent\n    }\n    \n    // Try to load pin_usage_log entries as additional fallback\n    try {\n      const { data: pinUsageData, error: pinUsageError } = await supabase\n        .from('pin_usage_log')\n        .select('transaction_id, promoter_id, customer_id, action_type, created_at')\n        .not('transaction_id', 'is', null);\n      \n      if (!pinUsageError && pinUsageData) {\n        pinUsageData.forEach(log => {\n          if (log.transaction_id) {\n            pinUsageLogMap.set(log.transaction_id, log);\n          }\n        });\n      } else if (pinUsageError) {\n        // Could not load pin_usage_log - silent\n      }\n    } catch (err) {\n      // Could not load pin_usage_log - silent\n    }\n\n    // Transform data for UI display\n    const transformedData = data.map(transaction => {\n      // First, infer action_type if it's NULL (needed for customer_creation lookup)\n      let inferredActionType = transaction.action_type;\n      if (!inferredActionType) {\n        if (transaction.note) {\n          const noteLower = transaction.note.toLowerCase();\n          if (noteLower.includes('customer creation') || noteLower.includes('customer')) {\n            inferredActionType = 'customer_creation';\n          } else if (noteLower.includes('admin allocation') || noteLower.includes('allocation')) {\n            inferredActionType = 'admin_allocation';\n          } else if (noteLower.includes('deduction')) {\n            inferredActionType = 'admin_deduction';\n          }\n        }\n        if (!inferredActionType) {\n          inferredActionType = transaction.pin_change_value > 0 ? 'admin_allocation' : 'customer_creation';\n        }\n      }\n      \n      // Try to get user from join first, then fallback to profiles map\n      let user = transaction.user;\n      \n      // If join failed or user is null, try fallback lookup\n      if (!user || !user.name) {\n        // First try: Direct user_id lookup\n        if (transaction.user_id && profilesMap.has(transaction.user_id)) {\n          user = profilesMap.get(transaction.user_id);\n        } \n        // Second try: For customer_creation transactions, try to find promoter via related_entity_id (customer) -> parent_promoter_id\n        else if ((inferredActionType === 'customer_creation' || transaction.action_type === 'customer_creation') && transaction.related_entity_id) {\n          const customer = customersMap.get(transaction.related_entity_id);\n          if (customer && customer.parent_promoter_id) {\n            const promoter = profilesMap.get(customer.parent_promoter_id);\n            if (promoter) {\n              user = promoter;\n            }\n          }\n        }\n        // Third try: Check pin_usage_log table for matching transaction_id\n        if (!user || !user.name) {\n          if (transaction.transaction_id && pinUsageLogMap.has(transaction.transaction_id)) {\n            const pinUsageLog = pinUsageLogMap.get(transaction.transaction_id);\n            if (pinUsageLog.promoter_id && profilesMap.has(pinUsageLog.promoter_id)) {\n              user = profilesMap.get(pinUsageLog.promoter_id);\n            }\n          }\n          // Also try time-based matching with pin_usage_log if transaction_id doesn't match\n          else if (transaction.created_at && (inferredActionType === 'customer_creation' || transaction.action_type === 'customer_creation')) {\n            const transactionTime = new Date(transaction.created_at).getTime();\n            const timeWindow = 5000; // 5 seconds\n            \n            for (const [logTransactionId, pinUsageLog] of pinUsageLogMap.entries()) {\n              if (pinUsageLog.created_at && pinUsageLog.promoter_id) {\n                const logTime = new Date(pinUsageLog.created_at).getTime();\n                const timeDiff = Math.abs(transactionTime - logTime);\n                \n                if (timeDiff <= timeWindow && profilesMap.has(pinUsageLog.promoter_id)) {\n                  user = profilesMap.get(pinUsageLog.promoter_id);\n                  break; // Use first match\n                }\n              }\n            }\n          }\n        }\n        // Fourth try: For customer_creation with NULL related_entity_id, try to find customer created at same time\n        if (!user || !user.name) {\n          if ((inferredActionType === 'customer_creation' || transaction.action_type === 'customer_creation') && !transaction.related_entity_id && transaction.created_at) {\n            // Find customers created within 5 seconds of this transaction\n            const transactionTime = new Date(transaction.created_at).getTime();\n            const timeWindow = 5000; // 5 seconds\n            \n            for (const [customerId, customer] of customersMap.entries()) {\n              if (customer.created_at) {\n                const customerTime = new Date(customer.created_at).getTime();\n                const timeDiff = Math.abs(transactionTime - customerTime);\n                \n                if (timeDiff <= timeWindow && customer.parent_promoter_id) {\n                  const promoter = profilesMap.get(customer.parent_promoter_id);\n                  if (promoter) {\n                    user = promoter;\n                    break; // Use first match\n                  }\n                }\n              }\n            }\n          }\n        }\n        \n        // User validation - no console output\n      }\n      \n      // Final check - if still no user, skip logging\n      if (!user || !user.name) {\n        // Error logging disabled - user data missing but continuing\n      }\n\n      // Normalize action_type - use inferred type if original was NULL\n      let actionType = inferredActionType || transaction.action_type;\n      if (!PIN_DISPLAY_CONFIG[actionType]) {\n        // If inferred type is not in config, use standard action types\n        if (actionType === 'customer_creation') {\n          actionType = PIN_ACTION_TYPES.CUSTOMER_CREATION;\n        } else if (actionType === 'admin_allocation') {\n          actionType = PIN_ACTION_TYPES.ADMIN_ALLOCATION;\n        } else if (actionType === 'admin_deduction') {\n          actionType = PIN_ACTION_TYPES.ADMIN_DEDUCTION;\n        } else {\n          // Final fallback\n          actionType = transaction.pin_change_value > 0 ? PIN_ACTION_TYPES.ADMIN_ALLOCATION : PIN_ACTION_TYPES.CUSTOMER_CREATION;\n        }\n        if (transaction.action_type !== actionType) {\n        }\n      }\n\n      // Get promoter_id - check multiple sources\n      let promoterId = null;\n      if (user?.promoter_id) {\n        promoterId = user.promoter_id;\n      } else if (user?.role === 'admin') {\n        // Admins might not have promoter_id, use a default or leave null\n        promoterId = null;\n      }\n      \n      return {\n      ...transaction,\n        action_type: actionType, // Use normalized action_type\n        displayConfig: PIN_DISPLAY_CONFIG[actionType] || {\n        emoji: 'â“',\n        label: 'Unknown',\n        color: 'gray',\n        sign: ''\n      },\n        formattedAmount: formatPinAmount(actionType, transaction.pin_change_value || 0),\n        // Use actual database values - never hardcode\n        userName: user?.name || null, // Will be handled in UI\n        userEmail: user?.email || null,\n        userRole: user?.role || null,\n        userPromoterId: promoterId, // Actual promoter_id from database\n        creatorName: transaction.creator?.name || null\n      };\n    });\n\n    return transformedData;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n * Get user's current PIN balance\n */\nexport const getUserPinBalance = async (userId) => {\n  try {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('pins')\n      .eq('id', userId)\n      .single();\n\n    if (error) throw error;\n\n    return data.pins || 0;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n * Get PIN transaction statistics\n */\nexport const getPinTransactionStats = async (userId = null) => {\n  try {\n    let query = supabase\n      .from('pin_transactions')\n      .select('action_type, pin_change_value');\n\n    if (userId) {\n      query = query.eq('user_id', userId);\n    }\n\n    let { data, error } = await query;\n\n    if (error) throw error;\n\n    // If no stats found with user_id, try with promoter_id as a fallback for legacy data\n    if (data.length === 0 && userId) {\n      const { data: fallbackData, error: fallbackError } = await supabase\n        .from('pin_transactions')\n        .select('action_type, pin_change_value')\n        .eq('promoter_id', userId); // Fallback to promoter_id\n\n      if (fallbackError) throw fallbackError;\n      data = fallbackData;\n    }\n\n    // Calculate statistics\n    const stats = {\n      totalTransactions: data.length,\n      customerCreations: data.filter(t => t.action_type === PIN_ACTION_TYPES.CUSTOMER_CREATION).length,\n      adminAllocations: data.filter(t => t.action_type === PIN_ACTION_TYPES.ADMIN_ALLOCATION).length,\n      adminDeductions: data.filter(t => t.action_type === PIN_ACTION_TYPES.ADMIN_DEDUCTION).length,\n      totalPinsAllocated: data\n        .filter(t => t.action_type === PIN_ACTION_TYPES.ADMIN_ALLOCATION)\n        .reduce((sum, t) => sum + Math.abs(t.pin_change_value), 0),\n      totalPinsDeducted: data\n        .filter(t => t.action_type !== PIN_ACTION_TYPES.ADMIN_ALLOCATION)\n        .reduce((sum, t) => sum + Math.abs(t.pin_change_value), 0)\n    };\n\n    return stats;\n\n  } catch (error) {\n    throw error;\n  }\n};\n\n// =====================================================\n// UTILITY FUNCTIONS\n// =====================================================\n\n/**\n * Format PIN amount for display based on action type\n */\nexport const formatPinAmount = (actionType, pinChangeValue) => {\n  // Handle null or undefined values\n  if (pinChangeValue === null || pinChangeValue === undefined) {\n    return '0';\n  }\n  \n  const config = PIN_DISPLAY_CONFIG[actionType];\n  if (!config) return pinChangeValue.toString();\n\n  const absValue = Math.abs(pinChangeValue);\n  \n  // Force correct sign based on action type\n  if (actionType === PIN_ACTION_TYPES.ADMIN_ALLOCATION) {\n    return `+${absValue}`;\n  } else {\n    return `-${absValue}`;\n  }\n};\n\n/**\n * Get display configuration for action type\n */\nexport const getActionTypeDisplay = (actionType) => {\n  return PIN_DISPLAY_CONFIG[actionType] || {\n    emoji: 'â“',\n    label: 'Unknown',\n    color: 'gray',\n    sign: ''\n  };\n};\n\n/**\n * Validate PIN transaction parameters\n */\nexport const validatePinTransaction = (actionType, pinAmount, userId) => {\n  const errors = [];\n\n  if (!Object.values(PIN_ACTION_TYPES).includes(actionType)) {\n    errors.push('Invalid action type');\n  }\n\n  if (!pinAmount || pinAmount <= 0) {\n    errors.push('PIN amount must be greater than 0');\n  }\n\n  if (!userId) {\n    errors.push('User ID is required');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n/**\n * Real-time PIN balance subscription\n */\nexport const subscribeToPinBalance = (userId, callback) => {\n  const subscription = supabase\n    .channel('pin-balance-changes')\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'pin_transactions',\n        filter: `user_id=eq.${userId}`\n      },\n      (payload) => {\n        callback(payload);\n      }\n    )\n    .subscribe();\n\n  return subscription;\n};\n\n/**\n * Real-time PIN transactions subscription\n */\nexport const subscribeToPinTransactions = (callback, userId = null) => {\n  let filter = '';\n  if (userId) {\n    filter = `user_id=eq.${userId}`;\n  }\n\n  const subscription = supabase\n    .channel('pin-transactions-changes')\n    .on(\n      'postgres_changes',\n      {\n        event: '*',\n        schema: 'public',\n        table: 'pin_transactions',\n        filter: filter\n      },\n      (payload) => {\n        callback(payload);\n      }\n    )\n    .subscribe();\n\n  return subscription;\n};\n\nexport default {\n  // Core functions\n  executePinTransaction,\n  deductPinForCustomerCreation,\n  adminAllocatePins,\n  adminDeductPins,\n  \n  // Query functions\n  getUserPinTransactions,\n  getAllPinTransactions,\n  getUserPinBalance,\n  getPinTransactionStats,\n  \n  // Utility functions\n  formatPinAmount,\n  getActionTypeDisplay,\n  validatePinTransaction,\n  \n  // Real-time subscriptions\n  subscribeToPinBalance,\n  subscribeToPinTransactions,\n  \n  // Constants\n  PIN_ACTION_TYPES,\n  PIN_DISPLAY_CONFIG\n};\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Pin\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjE3IiB5Mj0iMjIiIC8+CiAgPHBhdGggZD0iTTUgMTdoMTR2LTEuNzZhMiAyIDAgMCAwLTEuMTEtMS43OWwtMS43OC0uOUEyIDIgMCAwIDEgMTUgMTAuNzZWNmgxYTIgMiAwIDAgMCAwLTRIOGEyIDIgMCAwIDAgMCA0aDF2NC43NmEyIDIgMCAwIDEtMS4xMSAxLjc5bC0xLjc4LjlBMiAyIDAgMCAwIDUgMTUuMjRaIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/pin\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pin = createLucideIcon('Pin', [\n  ['line', { x1: '12', x2: '12', y1: '17', y2: '22', key: '1jrz49' }],\n  [\n    'path',\n    {\n      d: 'M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z',\n      key: '13yl11',\n    },\n  ],\n]);\n\nexport default Pin;\n"],"names":["FileText","createLucideIcon","d","key","points","x1","x2","y1","y2","PIN_REQUEST_STATUS","PENDING","APPROVED","REJECTED","PIN_REQUEST_CONFIG","emoji","label","color","description","getPinRequests","async","promoterId","arguments","length","undefined","status","limit","data","tableCheck","error","tableError","supabase","from","select","code","console","warn","rpc","p_promoter_id","p_status","p_limit","_error$message2","simpleQuery","order","ascending","eq","directData","directError","map","request","_objectSpread","requested_pins","quantity","request_number","request_id","approved_by","processed_by","approved_at","response_date","promoter_name","promoter_email","admin_name","statusConfig","formattedRequestNumber","formatted_request_id","concat","String","padStart","formattedDate","Date","created_at","toLocaleDateString","formattedTime","toLocaleTimeString","hour","minute","message","includes","manualApproveRequest","requestId","adminId","adminNotes","requestError","single","Error","pinResult","pinTransactionService","promoter_id","success","updateError","update","admin_notes","toISOString","allocated_pins","new_balance","balance_after","manualRejectRequest","submitPinRequest","requestedPins","reason","p_requested_pins","p_reason","_error$message","pendingCheck","insertData","insertError","insert","category","urgency","id","approvePinRequest","p_request_id","p_admin_id","p_admin_notes","rejectPinRequest","getPinRequestStats","requests","totalRequests","pendingRequests","filter","r","approvedRequests","rejectedRequests","totalPinsRequested","reduce","sum","totalPinsApproved","hasPendingRequests","subscribeToPinRequests","callback","channel","on","event","schema","table","payload","subscribe","formatPinRequest","displayTitle","displayStatus","displayDate","displayReason","validatePinRequest","errors","push","isValid","Send","XCircle","cx","cy","PIN_ACTION_TYPES","CUSTOMER_CREATION","ADMIN_ALLOCATION","ADMIN_DEDUCTION","PIN_DISPLAY_CONFIG","sign","getUserPinBalance","userId","pins","formatPinAmount","actionType","pinChangeValue","toString","absValue","Math","abs","getActionTypeDisplay","executePinTransaction","createdBy","relatedEntityId","relatedEntityName","_ref","p_user_id","p_action_type","p_pin_change_value","p_created_by","p_related_entity_id","p_related_entity_name","deductPinForCustomerCreation","customerId","customerName","p_customer_id","p_customer_name","adminAllocatePins","targetUserId","pinAmount","p_target_user_id","p_pin_amount","adminDeductPins","getUserPinTransactions","fallbackData","fallbackError","transaction","_transaction$creator","displayConfig","action_type","formattedAmount","pin_change_value","creatorName","creator","name","getAllPinTransactions","filters","query","dateFrom","gte","dateTo","lte","t","user","profilesMap","Map","customersMap","pinUsageLogMap","profilesData","profilesError","in","forEach","p","set","role","err","pinUsageData","pinUsageError","not","log","transaction_id","_user","_user2","_user3","_user4","_user5","_transaction$creator2","inferredActionType","note","noteLower","toLowerCase","user_id","has","get","related_entity_id","customer","parent_promoter_id","promoter","pinUsageLog","transactionTime","getTime","timeWindow","logTransactionId","entries","logTime","customerTime","userName","userEmail","email","userRole","userPromoterId","getPinTransactionStats","totalTransactions","customerCreations","adminAllocations","adminDeductions","totalPinsAllocated","totalPinsDeducted","validatePinTransaction","Object","values","subscribeToPinBalance","subscribeToPinTransactions","Pin"],"sourceRoot":""}