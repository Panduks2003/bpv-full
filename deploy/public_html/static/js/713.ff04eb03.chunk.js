"use strict";(self.webpackChunkbrightplanet_ventures=self.webpackChunkbrightplanet_ventures||[]).push([[713],{1754:(e,s,t)=>{t.d(s,{YB:()=>u,bT:()=>o,cU:()=>d,xk:()=>m});t(5043);var a=t(579);const r="rgba(247, 147, 30, 0.1)",n="rgba(255, 255, 255, 0.05)",i="\n  @keyframes bp-skeleton-shimmer {\n    0% {\n      background-position: -200px 0;\n    }\n    100% {\n      background-position: calc(200px + 100%) 0;\n    }\n  }\n  \n  .bp-skeleton-shimmer {\n    background: linear-gradient(\n      90deg,\n      ".concat(n," 25%,\n      ").concat(r," 50%,\n      ").concat(n," 75%\n    );\n    background-size: 200px 100%;\n    animation: bp-skeleton-shimmer 1.5s infinite linear;\n  }\n");if("undefined"!==typeof document&&!document.getElementById("bp-skeleton-styles")){const e=document.createElement("style");e.id="bp-skeleton-styles",e.textContent=i,document.head.appendChild(e)}const l=e=>{let{width:s="100%",height:t="1rem",className:r="",rounded:i="rounded-lg",animate:l=!0}=e;return(0,a.jsx)("div",{className:"".concat(i," border border-white/10 ").concat(l?"bp-skeleton-shimmer":""," ").concat(r),style:{width:s,height:t,background:l?void 0:n}})},c=e=>{let{className:s=""}=e;return(0,a.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-4 h-full ".concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(l,{width:"3rem",height:"3rem",rounded:"rounded-xl"}),(0,a.jsx)(l,{width:"3rem",height:"2rem"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l,{width:"70%",height:"1rem"}),(0,a.jsx)(l,{width:"90%",height:"0.75rem"})]})]})},d=e=>{let{rows:s=5,columns:t=4,className:r=""}=e;return(0,a.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl overflow-hidden ".concat(r),children:[(0,a.jsx)("div",{className:"bg-white/5 p-4 border-b border-white/10",children:(0,a.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(".concat(t,", 1fr)")},children:Array.from({length:t}).map((e,s)=>(0,a.jsx)(l,{width:"80%",height:"1rem"},s))})}),(0,a.jsx)("div",{className:"divide-y divide-white/10",children:Array.from({length:s}).map((e,s)=>(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(".concat(t,", 1fr)")},children:Array.from({length:t}).map((e,s)=>(0,a.jsx)(l,{width:0===s?"90%":"70%",height:"1rem"},s))})},s))})]})},o=e=>{let{count:s=2,className:t=""}=e;return(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ".concat(t),children:Array.from({length:s}).map((e,s)=>(0,a.jsx)(c,{},s))})},m=e=>{let{count:s=4,className:t=""}=e;return(0,a.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 ".concat(t),children:Array.from({length:s}).map((e,s)=>(0,a.jsx)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-5 h-full",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(l,{width:"3.5rem",height:"3.5rem",rounded:"rounded-xl",className:"mx-auto"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l,{width:"70%",height:"1rem",className:"mx-auto"}),(0,a.jsx)(l,{width:"90%",height:"0.75rem",className:"mx-auto"})]})]})},s))})},x=e=>{let{className:s=""}=e;return(0,a.jsxs)("div",{className:"text-center mb-6 ".concat(s),children:[(0,a.jsx)(l,{width:"4rem",height:"4rem",rounded:"rounded-2xl",className:"mx-auto mb-4"}),(0,a.jsx)(l,{width:"15rem",height:"2rem",className:"mx-auto mb-2"}),(0,a.jsx)(l,{width:"20rem",height:"1rem",className:"mx-auto"})]})},h=e=>{let{className:s=""}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6 ".concat(s),children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(l,{width:"100%",height:"2.5rem",rounded:"rounded-lg"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l,{width:"8rem",height:"2.5rem",rounded:"rounded-lg"}),(0,a.jsx)(l,{width:"6rem",height:"2.5rem",rounded:"rounded-lg"})]})]})},p=e=>{let{className:s=""}=e;return(0,a.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6 ".concat(s),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l,{width:"8rem",height:"1rem"}),(0,a.jsx)(l,{width:"6rem",height:"0.75rem"})]}),(0,a.jsx)(l,{width:"4rem",height:"1.5rem",rounded:"rounded-full"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(l,{width:"4rem",height:"0.75rem"}),(0,a.jsx)(l,{width:"6rem",height:"0.75rem"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(l,{width:"5rem",height:"0.75rem"}),(0,a.jsx)(l,{width:"7rem",height:"0.75rem"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4 pt-4 border-t border-white/10",children:[(0,a.jsx)(l,{width:"4rem",height:"2rem",rounded:"rounded-lg"}),(0,a.jsx)(l,{width:"4rem",height:"2rem",rounded:"rounded-lg"})]})]})},u=e=>{let{type:s="dashboard"}=e;switch(s){case"dashboard":return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[(0,a.jsx)(x,{}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l,{width:"10rem",height:"1.5rem",className:"mb-4"}),(0,a.jsx)(o,{})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l,{width:"12rem",height:"1.5rem",className:"mb-4"}),(0,a.jsx)(m,{})]})]})]})});case"table":return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[(0,a.jsx)(x,{}),(0,a.jsx)(h,{}),(0,a.jsx)(d,{rows:8,columns:5})]})});case"cards":return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[(0,a.jsx)(x,{}),(0,a.jsx)(h,{}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,s)=>(0,a.jsx)(p,{},s))})]})});default:return(0,a.jsx)(u,{type:"dashboard"})}}},6787:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(3797).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},7713:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(2555),r=t(5043),n=t(6621),i=t(3216),l=t(1460),c=t(3959),d=t(6127),o=t(5229),m=t(8268),x=t(9213),h=t(3458),p=t(917),u=t(1065),g=t(1537),j=t(254),N=t(579);const f=e=>{let{adminId:s,onSuccess:t,onError:a}=e;const[n,i]=(0,r.useState)([]),[l,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)({totalRequests:0,pendingRequests:0,approvedRequests:0,rejectedRequests:0}),[f,y]=(0,r.useState)(null),[b,w]=(0,r.useState)(!1),[v,A]=(0,r.useState)(null),[k,q]=(0,r.useState)(""),[I,P]=(0,r.useState)(!1),C=async()=>{try{d(!0);const[e,s]=await Promise.all([j.Ay.getPinRequests(),j.Ay.getPinRequestStats()]);i(e),m(s)}catch(e){console.error("Failed to load PIN requests:",e),a("Failed to load PIN requests")}finally{d(!1)}};(0,r.useEffect)(()=>{C()},[]);const R=(e,s)=>{y(e),A(s),q(""),w(!0)};return(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,N.jsx)(c.Xg,{className:"p-6 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 border border-blue-500/30",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-blue-300 text-sm font-semibold uppercase tracking-wider",children:"Total Requests"}),(0,N.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:o.totalRequests})]}),(0,N.jsx)("div",{className:"w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center",children:(0,N.jsx)(x.A,{className:"w-6 h-6 text-blue-400"})})]})}),(0,N.jsx)(c.Xg,{className:"p-6 bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border border-yellow-500/30",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-yellow-300 text-sm font-semibold uppercase tracking-wider",children:"Pending"}),(0,N.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:o.pendingRequests})]}),(0,N.jsx)("div",{className:"w-12 h-12 bg-yellow-500/20 rounded-xl flex items-center justify-center",children:(0,N.jsx)(h.A,{className:"w-6 h-6 text-yellow-400"})})]})}),(0,N.jsx)(c.Xg,{className:"p-6 bg-gradient-to-br from-green-500/10 to-emerald-500/10 border border-green-500/30",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-green-300 text-sm font-semibold uppercase tracking-wider",children:"Approved"}),(0,N.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:o.approvedRequests})]}),(0,N.jsx)("div",{className:"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center",children:(0,N.jsx)(p.A,{className:"w-6 h-6 text-green-400"})})]})}),(0,N.jsx)(c.Xg,{className:"p-6 bg-gradient-to-br from-red-500/10 to-pink-500/10 border border-red-500/30",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-red-300 text-sm font-semibold uppercase tracking-wider",children:"Rejected"}),(0,N.jsx)("p",{className:"text-3xl font-bold text-white mt-1",children:o.rejectedRequests})]}),(0,N.jsx)("div",{className:"w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center",children:(0,N.jsx)(u.A,{className:"w-6 h-6 text-red-400"})})]})})]}),(0,N.jsxs)(c.Xg,{className:"overflow-hidden",variant:"glassDark",children:[(0,N.jsx)("div",{className:"p-6 border-b border-gray-700/50",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-2xl font-semibold text-white",children:"PIN Requests Management"}),(0,N.jsx)("p",{className:"text-gray-300 text-sm mt-1",children:"Review and process promoter PIN requests"})]}),(0,N.jsxs)(c.Rq,{onClick:C,className:"flex items-center space-x-2 bg-orange-600 hover:bg-orange-700",disabled:l,children:[(0,N.jsx)(h.A,{className:"w-4 h-4"}),(0,N.jsx)("span",{children:"Refresh"})]})]})}),(0,N.jsx)("div",{className:"p-6",children:(0,N.jsx)(g.A,{requests:n,loading:l,showPromoter:!0,emptyMessage:"No PIN requests found",onApprove:e=>R(e,"approve"),onReject:e=>R(e,"reject"),showActions:!0})})]}),b&&f&&(0,N.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,N.jsx)(c.Xg,{className:"w-full max-w-md",variant:"glassDark",children:(0,N.jsxs)("div",{className:"p-6",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center ".concat("approve"===v?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-pink-500"),children:"approve"===v?(0,N.jsx)(p.A,{className:"w-5 h-5 text-white"}):(0,N.jsx)(u.A,{className:"w-5 h-5 text-white"})}),(0,N.jsxs)("h3",{className:"text-xl font-semibold text-white",children:["approve"===v?"Approve":"Reject"," PIN Request"]})]}),(0,N.jsx)("button",{onClick:()=>w(!1),disabled:I,className:"text-gray-300 hover:text-white transition-colors disabled:opacity-50",children:(0,N.jsx)(u.A,{className:"w-5 h-5"})})]}),(0,N.jsx)("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6",children:(0,N.jsxs)("div",{className:"space-y-3",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Request ID:"}),(0,N.jsx)("span",{className:"text-white font-mono",children:f.formattedRequestNumber})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Promoter:"}),(0,N.jsx)("span",{className:"text-white",children:f.promoter_name})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Requested PINs:"}),(0,N.jsx)("span",{className:"text-orange-400 font-bold",children:f.requested_pins})]}),(0,N.jsxs)("div",{className:"flex items-start justify-between",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Reason:"}),(0,N.jsx)("span",{className:"text-white text-right max-w-xs",children:f.reason||"No reason provided"})]})]})}),(0,N.jsxs)("div",{className:"mb-6",children:[(0,N.jsxs)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:["Admin Notes ","reject"===v&&(0,N.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,N.jsx)("textarea",{value:k,onChange:e=>q(e.target.value),placeholder:"approve"===v?"Optional notes about the approval...":"Reason for rejection (required)...",rows:3,disabled:I,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500/20 resize-none transition-colors disabled:opacity-50"})]}),(0,N.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,N.jsx)(c.Rq,{variant:"secondary",onClick:()=>w(!1),disabled:I,children:"Cancel"}),(0,N.jsx)(c.Rq,{onClick:async()=>{if(f&&v)try{if(P(!0),"approve"===v){const e=await j.Ay.approvePinRequest(f.id,s,k||null);t("PIN Request Approved!\n\nRequest: ".concat(f.formattedRequestNumber,"\nPINs Allocated: ").concat(f.requested_pins,"\nNew Balance: ").concat(e.new_balance))}else await j.Ay.rejectPinRequest(f.id,s,k||"Request rejected by admin"),t("PIN Request Rejected!\n\nRequest: ".concat(f.formattedRequestNumber,"\nReason: ").concat(k||"No reason provided"));await C(),w(!1),y(null),A(null),q("")}catch(e){console.error("Failed to process request:",e),a("Failed to ".concat(v," request: ").concat(e.message))}finally{P(!1)}},disabled:I||"reject"===v&&!k.trim(),className:"flex items-center space-x-2 ".concat("approve"===v?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700":"bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700"," disabled:opacity-50 disabled:cursor-not-allowed"),children:I?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white/30 border-t-white"}),(0,N.jsx)("span",{children:"Processing..."})]}):(0,N.jsxs)(N.Fragment,{children:["approve"===v?(0,N.jsx)(p.A,{className:"w-4 h-4"}):(0,N.jsx)(u.A,{className:"w-4 h-4"}),(0,N.jsx)("span",{children:"approve"===v?"Approve & Allocate":"Reject Request"})]})})]})]})})})]})};var y=t(2380),b=t(98),w=t(430),v=t(8112),A=t(9256),k=t(6787),q=t(1172),I=t(5897),P=t(1754);const C=function(){const{user:e,logout:s}=(0,n.As)();(0,i.Zp)(),(0,c.r9)();const[t,h]=(0,r.useState)([]),[g,j]=(0,r.useState)([]),[C,R]=(0,r.useState)([]),[S,D]=(0,r.useState)([]),[_,T]=(0,r.useState)(""),[M,E]=(0,r.useState)("all"),[L,O]=(0,r.useState)("requests"),[F,U]=(0,r.useState)(!0),[X,z]=(0,r.useState)(!1),[B,J]=(0,r.useState)(null),[W,H]=(0,r.useState)(!1),[V,G]=(0,r.useState)(!1),[Z,Q]=(0,r.useState)({action:"approve",adminNotes:""}),[Y,K]=(0,r.useState)(!1),[$,ee]=(0,r.useState)(null),[se,te]=(0,r.useState)({promoterId:"",pins:"",action:"add"}),[ae,re]=(0,r.useState)({}),[ne,ie]=(0,r.useState)({show:!1,message:"",type:""}),le=function(e){ie({show:!0,message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>{ie({show:!1,message:"",type:""})},4e3)};(0,r.useEffect)(()=>{ce();const e=setInterval(()=>{ce()},3e4);return()=>clearInterval(e)},[]);const ce=async()=>{await Promise.all([de(),oe()])};(0,r.useEffect)(()=>{let e=t||[];"all"!==M&&(e=e.filter(e=>e.actionType===M)),_&&(e=e.filter(e=>{const s=(e.requestId||"").toLowerCase(),t=(e.promoterEmail||"").toLowerCase(),a=(e.promoterName||"").toLowerCase(),r=(_||"").toLowerCase();return s.includes(r)||t.includes(r)||a.includes(r)})),e.sort((e,s)=>new Date(s.requestDate)-new Date(e.requestDate)),j(e)},[t,_,M]);const de=async()=>{try{U(!0);const e=await o.Ay.getAllPinTransactions({actionType:"all"!==M?M:void 0});console.log("\ud83d\udccb PIN transactions loaded:",e.length,"entries");const s=e.map(e=>({id:e.id,requestId:e.transaction_id,quantity:e.pin_change_value,status:"completed",promoterId:e.user_id,promoterEmail:e.userEmail,promoterName:e.userName,promoterGeneratedId:"PROM".concat(String(Math.floor(9999*Math.random())).padStart(4,"0")),requestDate:e.created_at,responseDate:e.created_at,adminNotes:e.note,actionType:e.action_type,customerName:null,displayConfig:e.displayConfig,formattedAmount:e.formattedAmount}));h(s),j(s)}catch(e){console.error("Error loading PIN transactions:",e),h([]),j([])}finally{U(!1)}},oe=async()=>{try{const{data:e,error:s}=await d.ND.from("profiles").select("id, name, email, pins, promoter_id, created_at").eq("role","promoter").order("created_at",{ascending:!1});if(!s&&e){const s=e.map(e=>({id:e.id,name:e.name||"Unknown",email:e.email||"Unknown",promoter_id:e.promoter_id||"N/A",pins:e.pins||0,created_at:e.created_at}));R(s),D(s),console.log("\ud83d\udc65 Admin loaded promoters:",s.length)}else console.error("Error loading promoters:",s),R([]),D([])}catch(e){console.error("Error loading promoters:",e),R([]),D([])}},me=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ee(e),te({promoterId:(null===e||void 0===e?void 0:e.id)||"",pins:"",action:"add"}),re({}),K(!0)},xe=()=>{K(!1),ee(null),te({promoterId:"",pins:"",action:"add"}),re({})};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(c.wE,{}),(0,N.jsx)(l.A,{}),(0,N.jsxs)(c.dQ,{children:[(0,N.jsx)("div",{className:"min-h-screen p-8",children:(0,N.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,N.jsxs)("div",{className:"flex justify-between items-center mb-8","data-animate":!0,children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Pin Management System"}),(0,N.jsx)("p",{className:"text-gray-300",children:"Manage pin requests and direct pin allocation"})]}),(0,N.jsxs)(c.Rq,{onClick:()=>me(),className:"flex items-center space-x-2",children:[(0,N.jsx)(y.A,{className:"w-5 h-5"}),(0,N.jsx)("span",{children:"Allocate Pins"})]})]}),(0,N.jsx)("div",{className:"flex space-x-1 mb-8","data-animate":!0,children:[{id:"requests",label:"Pin History",icon:b.A},{id:"pin-requests",label:"PIN Requests",icon:w.A},{id:"direct",label:"Manage Pins",icon:v.A}].map(e=>{const s=e.icon;return(0,N.jsxs)("button",{onClick:()=>O(e.id),className:"flex items-center space-x-2 px-6 py-3 rounded-lg font-medium transition-all duration-300 ".concat(L===e.id?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow-lg":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50 hover:text-white"),children:[(0,N.jsx)(s,{className:"w-5 h-5"}),(0,N.jsx)("span",{children:e.label})]},e.id)})}),(0,N.jsx)("div",{className:"mb-8","data-animate":!0,children:(0,N.jsx)(m.Wx,{stats:{totalTransactions:t.length,customerCreations:t.filter(e=>e.actionType===o.hO.CUSTOMER_CREATION).length,adminAllocations:t.filter(e=>e.actionType===o.hO.ADMIN_ALLOCATION).length,adminDeductions:t.filter(e=>e.actionType===o.hO.ADMIN_DEDUCTION).length,totalPinsAllocated:t.filter(e=>e.actionType===o.hO.ADMIN_ALLOCATION).reduce((e,s)=>e+Math.abs(s.quantity||0),0),totalPinsDeducted:t.filter(e=>e.actionType!==o.hO.ADMIN_ALLOCATION).reduce((e,s)=>e+Math.abs(s.quantity||0),0)},loading:F})}),(0,N.jsx)(c.Xg,{className:"p-6 mb-8",variant:"glassDark","data-animate":!0,children:(0,N.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,N.jsxs)("div",{className:"flex-1 relative",children:[(0,N.jsx)(A.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,N.jsx)("input",{type:"text",placeholder:"Search by transaction ID (BPV-CC01, BPV-AA01), promoter name, or email...",value:_,onChange:e=>T(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,N.jsx)("div",{className:"md:w-48",children:(0,N.jsxs)("select",{value:M,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,N.jsx)("option",{value:"all",children:"All Actions"}),(0,N.jsx)("option",{value:"customer_creation",children:"Customer Creation"}),(0,N.jsx)("option",{value:"admin_allocation",children:"Admin Allocation"}),(0,N.jsx)("option",{value:"admin_deduction",children:"Admin Deduction"})]})})]})}),"requests"===L&&(0,N.jsx)(c.Xg,{className:"overflow-hidden",variant:"glassDark","data-animate":!0,children:F?(0,N.jsx)(P.cU,{rows:6,columns:5}):(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full",children:[(0,N.jsx)("thead",{className:"bg-gray-800/50",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Transaction ID"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Promoter"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Pins"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Action Type"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Date"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Notes"})]})}),(0,N.jsx)("tbody",{className:"divide-y divide-gray-700/50",children:0===g.length?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-400",children:"No pin transactions found"})}):g.map(e=>(0,N.jsxs)("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,N.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:e.requestId})}),(0,N.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,N.jsx)("div",{className:"text-sm font-medium text-white",children:e.promoterName}),(0,N.jsx)("div",{className:"text-xs text-gray-400",children:e.promoterEmail})]}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,N.jsx)("div",{className:"flex items-center",children:(()=>{let s,t;return"admin_allocation"===e.actionType?(s=Math.abs(e.quantity),t=!0):"customer_creation"===e.actionType?(s=Math.abs(e.quantity),t=!1):(s=e.quantity,t=e.quantity>0),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(x.A,{className:"w-4 h-4 mr-2 ".concat(t?"text-green-400":"text-red-400")}),(0,N.jsxs)("span",{className:"text-lg font-bold ".concat(t?"text-green-300":"text-red-300"),children:[t?"+":"-",s]})]})})()})}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,N.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("customer_creation"===e.actionType?"bg-blue-100 text-blue-800":"admin_allocation"===e.actionType?"bg-green-100 text-green-800":"admin_deduction"===e.actionType?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:"customer_creation"===e.actionType?"\u274c Customer Creation":"admin_allocation"===e.actionType?"\u2705 Admin Allocation":"admin_deduction"===e.actionType?"\u274c Admin Deduction":"\u2753 Unknown"})}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.requestDate?new Date(e.requestDate).toLocaleDateString():"N/A"}),(0,N.jsx)("td",{className:"px-6 py-4 text-sm text-gray-300 max-w-xs truncate",children:e.adminNotes||"No notes"})]},e.id))})]})})}),"pin-requests"===L&&(0,N.jsx)(f,{adminId:null===e||void 0===e?void 0:e.id,onSuccess:le,onError:e=>le(e,"error")}),"direct"===L&&(0,N.jsx)(c.Xg,{className:"overflow-hidden",variant:"glassDark","data-animate":!0,children:F?(0,N.jsx)(P.cU,{rows:6,columns:5}):(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full",children:[(0,N.jsx)("thead",{className:"bg-gray-800/50",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Promoter"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Email"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Current Pins"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Join Date"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,N.jsx)("tbody",{className:"divide-y divide-gray-700/50",children:0===C.length?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"5",className:"px-6 py-12 text-center text-gray-400",children:"No promoters found"})}):C.map(e=>(0,N.jsxs)("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full flex items-center justify-center mr-3",children:(0,N.jsx)(v.A,{className:"w-4 h-4 text-white"})}),(0,N.jsx)("div",{className:"text-sm font-medium text-white",children:e.name||"Unknown"})]})}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.email}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,N.jsxs)("div",{className:"flex items-center",children:[(0,N.jsx)(x.A,{className:"w-4 h-4 text-purple-400 mr-2"}),(0,N.jsx)("span",{className:"text-lg font-bold text-white",children:e.pins||0})]})}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,N.jsx)("div",{className:"flex space-x-2",children:(0,N.jsx)("button",{onClick:()=>me(e),className:"text-purple-400 hover:text-purple-300 transition-colors",title:"Manage Pins",children:(0,N.jsx)(k.A,{className:"w-4 h-4"})})})})]},e.id))})]})})})]})}),V&&B&&(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsx)(c.Xg,{className:"w-full max-w-lg mx-4",variant:"glassDark",children:(0,N.jsxs)("div",{className:"p-6",children:[(0,N.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,N.jsxs)("h3",{className:"text-lg font-semibold text-white",children:["approved"===Z.action?"Approve":"Reject"," Pin Request"]}),(0,N.jsx)("button",{onClick:()=>G(!1),className:"text-gray-400 hover:text-white transition-colors",children:(0,N.jsx)(q.A,{className:"w-5 h-5"})})]}),(0,N.jsxs)("div",{className:"space-y-6",children:[(0,N.jsx)("div",{className:"bg-gray-700/50 p-4 rounded-lg",children:(0,N.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,N.jsxs)("div",{className:"flex justify-between items-center",children:[(0,N.jsx)("span",{className:"text-gray-400",children:"Transaction ID:"}),(0,N.jsx)("span",{className:"text-white font-medium font-mono",children:B.requestId})]}),(0,N.jsxs)("div",{className:"flex justify-between items-center",children:[(0,N.jsx)("span",{className:"text-gray-400",children:"User:"}),(0,N.jsx)("span",{className:"text-white font-medium",children:B.promoterName})]}),(0,N.jsxs)("div",{className:"flex justify-between items-center",children:[(0,N.jsx)("span",{className:"text-gray-400",children:"Action Type:"}),(0,N.jsx)(m.GJ,{actionType:B.actionType,size:"small"})]}),(0,N.jsxs)("div",{className:"flex justify-between items-center",children:[(0,N.jsx)("span",{className:"text-gray-400",children:"PIN Change:"}),(0,N.jsx)(m.VC,{actionType:B.actionType,amount:B.quantity,size:"small"})]}),(0,N.jsxs)("div",{className:"flex justify-between items-center",children:[(0,N.jsx)("span",{className:"text-gray-400",children:"Date:"}),(0,N.jsx)("span",{className:"text-white font-medium",children:B.requestDate?new Date(B.requestDate).toLocaleDateString():"N/A"})]})]})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-gray-300 text-sm mb-2",children:"Admin Notes"}),(0,N.jsx)("textarea",{value:Z.adminNotes,onChange:e=>Q((0,a.A)((0,a.A)({},Z),{},{adminNotes:e.target.value})),placeholder:"Add notes for ".concat(Z.action," this request..."),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 resize-none"})]})]}),(0,N.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,N.jsx)(c.Rq,{variant:"secondary",onClick:()=>G(!1),children:"Cancel"}),(0,N.jsx)(c.Rq,{onClick:()=>(async(s,t)=>{try{z(!0);const{data:n,error:i}=await d.ND.from("promoters").select("pin_requests").eq("id",s.promoterId).single();if(i)throw i;let l=[];try{l=n.pin_requests?JSON.parse(n.pin_requests):[]}catch(r){l=[]}const c=l.findIndex(e=>e.requestId===s.requestId);if(-1===c)throw new Error("Request not found");{l[c]=(0,a.A)((0,a.A)({},l[c]),{},{status:t,responseDate:(new Date).toISOString(),adminNotes:Z.adminNotes||"Request ".concat(t," by admin"),adminId:e.id});const{error:r}=await d.ND.from("promoters").update({pin_requests:JSON.stringify(l),updated_at:(new Date).toISOString()}).eq("id",s.promoterId);if(r)throw r;if("approved"===t){const{data:e,error:a}=await d.ND.from("promoters").select("pins").eq("id",s.promoterId).single();if(a)throw a;const r=(null===e||void 0===e?void 0:e.pins)||0,n=r+(s.quantity||0),{error:i}=await d.ND.from("promoters").update({pins:n,updated_at:(new Date).toISOString()}).eq("id",s.promoterId);if(i)throw i;le("\ud83c\udf89 Pin request ".concat(t," successfully!\n\nPromoter's pin balance updated: ").concat(r," \u2192 ").concat(n," pins"),"success")}else le("\ud83c\udf89 Pin request ".concat(t," successfully!"),"success");G(!1),Q({action:"approve",adminNotes:""}),await de(),await oe()}}catch(n){console.error("Error ".concat(t," request:"),n),le("\u274c Failed to ".concat(t," request. Please try again."),"error")}finally{z(!1)}})(B,Z.action),disabled:X,className:"flex items-center space-x-2 ".concat("approved"===Z.action?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"),children:X?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(I.A,{className:"w-4 h-4 bp-animate-spin"}),(0,N.jsx)("span",{children:"Processing..."})]}):(0,N.jsxs)(N.Fragment,{children:["approved"===Z.action?(0,N.jsx)(p.A,{className:"w-4 h-4"}):(0,N.jsx)(u.A,{className:"w-4 h-4"}),(0,N.jsxs)("span",{children:["approved"===Z.action?"Approve":"Reject"," Request"]})]})})]})]})})}),Y&&(0,N.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,N.jsx)(c.Xg,{className:"w-full max-w-md mx-4",variant:"glassDark",children:(0,N.jsxs)("div",{className:"p-6",children:[(0,N.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold text-white",children:$?"Manage Pins - ".concat($.name):"Allocate Pins"}),(0,N.jsx)("button",{onClick:xe,className:"text-gray-400 hover:text-white transition-colors",children:(0,N.jsx)(q.A,{className:"w-5 h-5"})})]}),(0,N.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),(()=>{const e={};return se.promoterId||(e.promoterId="Please select a promoter"),(!se.pins||se.pins<=0)&&(e.pins="Please enter a valid number of pins"),re(e),0===Object.keys(e).length})()){z(!0);try{const s=C.find(e=>e.id===se.promoterId)||$;if(!s)throw new Error("Promoter not found");const t=parseInt(se.pins);let a;if(a="add"===se.action?await o.Ay.adminAllocatePins(s.id,t,e.id):await o.Ay.adminDeductPins(s.id,t,e.id),!a.success)throw new Error(a.error||"PIN transaction failed");le("\ud83c\udf89 Successfully ".concat("add"===se.action?"allocated":"deducted"," ").concat(t," PIN").concat(t>1?"s":""," ").concat("add"===se.action?"to":"from"," ").concat(s.name,"!\n\nNew balance: ").concat(a.balance_after," PINs"),"success"),xe(),await oe(),await de()}catch(t){console.error("Error updating pins:",t),le("\u274c Failed to ".concat(se.action," pins. Error: ").concat(t.message),"error")}finally{z(!1)}}},className:"space-y-4",children:[!$&&(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Promoter *"}),(0,N.jsxs)("select",{value:se.promoterId,onChange:e=>te((0,a.A)((0,a.A)({},se),{},{promoterId:e.target.value})),className:"w-full px-3 py-2 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 ".concat(ae.promoterId?"border-red-500":"border-gray-600"),children:[(0,N.jsx)("option",{value:"",children:"Select promoter"}),C.map(e=>(0,N.jsxs)("option",{value:e.id,children:[e.name," (",e.promoter_id,") - ",e.pins||0," pins"]},e.id))]}),ae.promoterId&&(0,N.jsx)("p",{className:"text-red-400 text-sm mt-1",children:ae.promoterId})]}),$&&(0,N.jsx)("div",{className:"bg-gray-700/50 p-4 rounded-lg",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-white font-medium",children:$.name}),(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:$.email})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsx)("p",{className:"text-gray-400 text-sm",children:"Current Pins"}),(0,N.jsx)("p",{className:"text-white font-bold text-lg",children:$.pins||0})]})]})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Action *"}),(0,N.jsxs)("select",{value:se.action,onChange:e=>te((0,a.A)((0,a.A)({},se),{},{action:e.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,N.jsx)("option",{value:"add",children:"Add Pins"}),(0,N.jsx)("option",{value:"subtract",children:"Subtract Pins"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Number of Pins *"}),(0,N.jsx)("input",{type:"number",min:"1",value:se.pins,onChange:e=>te((0,a.A)((0,a.A)({},se),{},{pins:e.target.value})),className:"w-full px-3 py-2 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 ".concat(ae.pins?"border-red-500":"border-gray-600"),placeholder:"Enter number of pins"}),ae.pins&&(0,N.jsx)("p",{className:"text-red-400 text-sm mt-1",children:ae.pins})]}),(0,N.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,N.jsx)(c.Rq,{type:"button",variant:"secondary",onClick:xe,children:"Cancel"}),(0,N.jsx)(c.Rq,{type:"submit",disabled:X,className:"flex items-center space-x-2",children:X?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(I.A,{className:"w-4 h-4 bp-animate-spin"}),(0,N.jsx)("span",{children:"Processing..."})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(x.A,{className:"w-4 h-4"}),(0,N.jsx)("span",{children:"add"===se.action?"Add Pins":"Subtract Pins"})]})})]})]})]})})}),ne.show&&(0,N.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-md p-4 rounded-lg shadow-lg border transition-all duration-300 ".concat("success"===ne.type?"bg-green-500/10 border-green-500/30 text-green-300":"bg-red-500/10 border-red-500/30 text-red-300"),children:(0,N.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,N.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center ".concat("success"===ne.type?"bg-green-500":"bg-red-500"),children:"success"===ne.type?(0,N.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,N.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,N.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,N.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,N.jsx)("div",{className:"flex-1",children:(0,N.jsx)("p",{className:"text-sm font-medium whitespace-pre-line",children:ne.message})}),(0,N.jsx)("button",{onClick:()=>ie({show:!1,message:"",type:""}),className:"text-gray-400 hover:text-white transition-colors",children:(0,N.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,N.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})]})}},8112:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(3797).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}}]);
//# sourceMappingURL=713.ff04eb03.chunk.js.map