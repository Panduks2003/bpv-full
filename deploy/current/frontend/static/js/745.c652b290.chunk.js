"use strict";(self.webpackChunkbrightplanet_ventures=self.webpackChunkbrightplanet_ventures||[]).push([[745],{2380:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(3797).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2631:(e,s,t)=>{t.d(s,{YB:()=>j});t(5043);var r=t(579);const a="rgba(247, 147, 30, 0.1)",l="rgba(255, 255, 255, 0.05)",n="\n  @keyframes bp-skeleton-shimmer {\n    0% {\n      background-position: -200px 0;\n    }\n    100% {\n      background-position: calc(200px + 100%) 0;\n    }\n  }\n  \n  .bp-skeleton-shimmer {\n    background: linear-gradient(\n      90deg,\n      ".concat(l," 25%,\n      ").concat(a," 50%,\n      ").concat(l," 75%\n    );\n    background-size: 200px 100%;\n    animation: bp-skeleton-shimmer 1.5s infinite linear;\n  }\n");if("undefined"!==typeof document&&!document.getElementById("bp-skeleton-styles")){const e=document.createElement("style");e.id="bp-skeleton-styles",e.textContent=n,document.head.appendChild(e)}const i=e=>{let{width:s="100%",height:t="1rem",className:a="",rounded:n="rounded-lg",animate:i=!0}=e;return(0,r.jsx)("div",{className:"".concat(n," border border-white/10 ").concat(i?"bp-skeleton-shimmer":""," ").concat(a),style:{width:s,height:t,background:i?void 0:l}})},o=e=>{let{className:s=""}=e;return(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-4 h-full ".concat(s),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)(i,{width:"3rem",height:"3rem",rounded:"rounded-xl"}),(0,r.jsx)(i,{width:"3rem",height:"2rem"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(i,{width:"70%",height:"1rem"}),(0,r.jsx)(i,{width:"90%",height:"0.75rem"})]})]})},d=e=>{let{rows:s=5,columns:t=4,className:a=""}=e;return(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl overflow-hidden ".concat(a),children:[(0,r.jsx)("div",{className:"bg-white/5 p-4 border-b border-white/10",children:(0,r.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(".concat(t,", 1fr)")},children:Array.from({length:t}).map((e,s)=>(0,r.jsx)(i,{width:"80%",height:"1rem"},s))})}),(0,r.jsx)("div",{className:"divide-y divide-white/10",children:Array.from({length:s}).map((e,s)=>(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(".concat(t,", 1fr)")},children:Array.from({length:t}).map((e,s)=>(0,r.jsx)(i,{width:0===s?"90%":"70%",height:"1rem"},s))})},s))})]})},c=e=>{let{count:s=2,className:t=""}=e;return(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-".concat(Math.min(s,4)," gap-4 ").concat(t),children:Array.from({length:s}).map((e,s)=>(0,r.jsx)(o,{},s))})},m=e=>{let{count:s=6,className:t=""}=e;return(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 ".concat(t),children:Array.from({length:s}).map((e,s)=>(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(i,{width:"8rem",height:"0.75rem"}),(0,r.jsx)(i,{width:"4rem",height:"2rem"})]}),(0,r.jsx)(i,{width:"3rem",height:"3rem",rounded:"rounded-xl"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(i,{width:"60%",height:"0.75rem"})})]},s))})},h=e=>{let{className:s=""}=e;return(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-4 ".concat(s),children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(i,{width:"3rem",height:"3rem",rounded:"rounded-full"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)(i,{width:"60%",height:"1rem"}),(0,r.jsx)(i,{width:"40%",height:"0.75rem"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(i,{width:"2rem",height:"2rem",rounded:"rounded-lg"}),(0,r.jsx)(i,{width:"2rem",height:"2rem",rounded:"rounded-lg"})]})]})})},x=e=>{let{className:s="",showButton:t=!1}=e;return(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8 ".concat(s),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i,{width:"15rem",height:"2.5rem",className:"mb-2"}),(0,r.jsx)(i,{width:"20rem",height:"1rem"})]}),t&&(0,r.jsx)(i,{width:"8rem",height:"2.5rem",rounded:"rounded-lg"})]})},p=e=>{let{tabs:s=3,className:t=""}=e;return(0,r.jsx)("div",{className:"flex space-x-1 mb-8 ".concat(t),children:Array.from({length:s}).map((e,s)=>(0,r.jsx)(i,{width:"8rem",height:"3rem",rounded:"rounded-lg"},s))})},u=e=>{let{className:s=""}=e;return(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6 mb-8 ".concat(s),children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(i,{width:"100%",height:"2.5rem",rounded:"rounded-lg"})}),(0,r.jsx)("div",{className:"md:w-48",children:(0,r.jsx)(i,{width:"100%",height:"2.5rem",rounded:"rounded-lg"})})]})})},g=e=>{let{className:s=""}=e;return(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-slate-200/10 rounded-xl p-6 ".concat(s),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(i,{width:"8rem",height:"1rem"}),(0,r.jsx)(i,{width:"6rem",height:"0.75rem"})]}),(0,r.jsx)(i,{width:"4rem",height:"1.5rem",rounded:"rounded-full"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(i,{width:"4rem",height:"0.75rem"}),(0,r.jsx)(i,{width:"6rem",height:"0.75rem"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(i,{width:"5rem",height:"0.75rem"}),(0,r.jsx)(i,{width:"7rem",height:"0.75rem"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 mt-4 pt-4 border-t border-white/10",children:[(0,r.jsx)(i,{width:"4rem",height:"2rem",rounded:"rounded-lg"}),(0,r.jsx)(i,{width:"4rem",height:"2rem",rounded:"rounded-lg"})]})]})},j=e=>{let{type:s="dashboard"}=e;switch(s){case"dashboard":return(0,r.jsx)("div",{className:"min-h-screen p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)(x,{}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)(c,{count:4}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,s)=>(0,r.jsx)(o,{},s))})]})]})});case"pin-management":return(0,r.jsx)("div",{className:"min-h-screen p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)(x,{showButton:!0}),(0,r.jsx)(p,{tabs:3}),(0,r.jsx)(m,{count:6}),(0,r.jsx)(u,{}),(0,r.jsx)(d,{rows:8,columns:5})]})});case"customers":case"promoters":return(0,r.jsx)("div",{className:"min-h-screen p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)(x,{showButton:!0}),(0,r.jsx)(u,{}),(0,r.jsx)("div",{className:"space-y-4",children:Array.from({length:8}).map((e,s)=>(0,r.jsx)(h,{},s))})]})});case"withdrawals":return(0,r.jsx)("div",{className:"min-h-screen p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)(x,{}),(0,r.jsx)(u,{}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,s)=>(0,r.jsx)(g,{},s))})]})});default:return(0,r.jsx)(j,{type:"dashboard"})}}},3395:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(3797).A)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},4999:(e,s,t)=>{t.d(s,{A:()=>c});var r=t(2555),a=t(5043),l=(t(6127),t(917)),n=t(5897),i=t(1172),o=t(579);const d=a.memo(e=>{let{onSubmit:s,onCancel:t,loading:d=!1,editingPromoter:c=null,availableParents:m=[],adminUsers:h=[]}=e;const[x,p]=(0,a.useState)({name:"",email:"",hasEmail:!1,password:"password123",confirmPassword:"password123",phone:"",address:"",parentPromoter:""}),[u,g]=(0,a.useState)({}),[j,v]=(0,a.useState)(!1),[f,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(c){const e=c.email||"",s=e&&!e.includes("noemail+")&&!e.includes("@brightplanetventures.local");p({name:c.name||"",email:s?e:"",hasEmail:s,password:"password123",confirmPassword:"password123",phone:c.phone||"",address:c.address||"",parentPromoter:c.parent_promoter_id||""})}},[c]);const b=(0,a.useMemo)(()=>[...(h||[]).map(e=>({id:e.id,label:"\ud83d\udc51 ".concat(e.name," (Admin)"),type:"admin"})),...(m||[]).map(e=>({id:e.id||e._id,label:e.isCurrentUser?"".concat(e.promoter_id||"CURRENT"," - ").concat(e.name," (You)"):"".concat(e.promoter_id||"N/A"," - ").concat(e.name||"Unknown"),type:"promoter"}))],[h,m]),N=(0,a.useCallback)((e,s)=>{const t={};switch(e){case"name":s&&s.trim()?/^[a-zA-Z\s]+$/.test(s.trim())?s.trim().length<2&&(t.name="Name must be at least 2 characters"):t.name="Name must contain only letters and spaces":t.name="Name is required";break;case"email":if(x.hasEmail)if(s&&s.trim()){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim())||(t.email="Please enter a valid email address")}else t.email="Email address is required";break;case"password":c||(s?s.length<8?t.password="Password must be at least 8 characters":/(?=.*[a-zA-Z])(?=.*\d)/.test(s)||(t.password="Password must contain both letters and numbers"):t.password="Password is required");break;case"confirmPassword":c||s===x.password||(t.confirmPassword="Passwords do not match");break;case"phone":s?/^[6-9]\d{9}$/.test(s)||(t.phone="Enter a valid 10-digit Indian mobile number (starting with 6-9)"):t.phone="Phone number is required";break;case"parentPromoter":!s&&b.length>1&&(t.parentPromoter="Parent promoter selection is required")}return t},[x.hasEmail,x.password,c,b]),y=(0,a.useCallback)((e,s)=>{p(t=>(0,r.A)((0,r.A)({},t),{},{[e]:s}));const t=N(e,s);g(e=>(0,r.A)((0,r.A)({},e),t)),!t[e]&&u[e]&&g(s=>{const t=(0,r.A)({},s);return delete t[e],t})},[N,u]),_=(0,a.useCallback)(()=>{const e={};return Object.keys(x).forEach(s=>{const t=N(s,x[s]);Object.assign(e,t)}),g(e),0===Object.keys(e).length},[x,N,c]);(0,a.useEffect)(()=>{1!==b.length||x.parentPromoter||p(e=>(0,r.A)((0,r.A)({},e),{},{parentPromoter:b[0].id}))},[b,x.parentPromoter]);const k=(0,a.useCallback)(async e=>{if(e.preventDefault(),!_())return;const t={name:x.name,email:x.hasEmail&&x.email?x.email:null,password:x.password,phone:x.phone,address:x.address||null,parentPromoter:x.parentPromoter||null,useNewSystem:!0};await s(t)},[x,_,s]);return(0,o.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-700 pb-4 mb-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-white",children:c?"Edit Promoter":"Create New Promoter"}),c&&(0,o.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Update promoter information and hierarchy"})]}),(0,o.jsx)("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-white transition-colors",disabled:d,children:(0,o.jsx)(i.A,{className:"w-5 h-5"})})]}),(0,o.jsxs)("form",{onSubmit:k,className:"space-y-5",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Full Name",(0,o.jsx)("span",{className:"text-orange-400 ml-1",children:"*"})]}),(0,o.jsx)("input",{type:"text",value:x.name,onChange:e=>y("name",e.target.value),className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(u.name?"border-red-500":"border-gray-600"),placeholder:"Enter full name (letters and spaces only)"}),u.name&&(0,o.jsx)("p",{className:"text-red-400 text-sm mt-1",children:u.name})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("div",{className:"flex items-center mb-2",children:[(0,o.jsx)("input",{type:"checkbox",id:"hasEmail",checked:x.hasEmail,onChange:e=>{const s=e.target.checked;p(e=>(0,r.A)((0,r.A)({},e),{},{hasEmail:s,email:s?e.email:""})),s||g(e=>{const s=(0,r.A)({},e);return delete s.email,s})},className:"mr-2 h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-600 rounded bg-gray-700"}),(0,o.jsx)("label",{htmlFor:"hasEmail",className:"text-sm font-medium text-gray-300",children:"Add Email Address"})]}),x.hasEmail&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"email",value:x.email,onChange:e=>y("email",e.target.value),className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(u.email?"border-red-500":"border-gray-600"),placeholder:"Enter email address (can be shared with others)"}),u.email&&(0,o.jsx)("p",{className:"text-red-400 text-sm mt-1",children:u.email})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Phone Number",(0,o.jsx)("span",{className:"text-orange-400 ml-1",children:"*"})]}),(0,o.jsx)("input",{type:"tel",value:x.phone,onChange:e=>y("phone",e.target.value.replace(/\D/g,"").slice(0,10)),className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(u.phone?"border-red-500":"border-gray-600"),placeholder:"Enter 10-digit mobile number",maxLength:10}),u.phone&&(0,o.jsx)("p",{className:"text-red-400 text-sm mt-1",children:u.phone})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Address",(0,o.jsx)("span",{className:"text-gray-500 text-xs ml-2",children:"(Optional)"})]}),(0,o.jsx)("textarea",{value:x.address,onChange:e=>y("address",e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter full postal address (optional)",rows:3})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Parent Promoter",(0,o.jsx)("span",{className:"text-orange-400 ml-1",children:"*"})]}),(0,o.jsxs)("select",{value:x.parentPromoter,onChange:e=>y("parentPromoter",e.target.value),disabled:1===b.length||c,className:"w-full px-4 py-3 bg-gray-700 border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 ".concat(u.parentPromoter?"border-red-500":"border-gray-600"," ").concat(1===b.length||c?"opacity-75 cursor-not-allowed":""),children:[0===b.length&&(0,o.jsx)("option",{value:"",children:"Select parent promoter"}),b.map(e=>(0,o.jsx)("option",{value:e.id,children:e.label},e.id))]}),1===b.length&&!c&&(0,o.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"\ud83d\udca1 Automatically set as your downline promoter"}),u.parentPromoter&&(0,o.jsx)("p",{className:"text-red-400 text-sm mt-1",children:u.parentPromoter})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-700",children:[(0,o.jsx)("button",{type:"button",onClick:t,className:"px-6 py-3 text-gray-300 hover:text-white transition-colors",disabled:d,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",disabled:d||Object.keys(u).length>0,className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.A,{className:"w-4 h-4 animate-spin"}),(0,o.jsx)("span",{children:c?"Updating...":"Creating..."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.A,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:c?"Update Promoter":"Create Promoter"})]})})]})]})]})});d.displayName="UnifiedPromoterForm";const c=d},5680:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(3797).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},8112:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(3797).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},8745:(e,s,t)=>{t.r(s),t.d(s,{default:()=>w});var r=t(5043),a=t(6621),l=t(3216),n=t(6127),i=t(5559),o=t(4999),d=t(3959),c=t(2631),m=t(7607),h=t(3395),x=t(9589),p=t(5680),u=t(2380),g=t(9256),j=t(8112),v=t(1172),f=t(579);const w=function(){const{user:e}=(0,a.As)(),s=(0,l.Zp)(),[t,w]=(0,r.useState)(!0),[b,N]=(0,r.useState)([]),[y,_]=(0,r.useState)([]),[k,A]=(0,r.useState)(null),[P,C]=(0,r.useState)(""),[E,S]=(0,r.useState)("all"),[D,L]=(0,r.useState)(null),[U,q]=(0,r.useState)(!1),[F,M]=(0,r.useState)(!1),[B,I]=(0,r.useState)(!1),[T,O]=(0,r.useState)({total:0,level1:0,level2Plus:0,maxDepth:0});(0,d.r9)(),(0,r.useEffect)(()=>{z()},[e]);const z=async()=>{if(null!==e&&void 0!==e&&e.promoter_id)try{w(!0),A("");const{data:s,error:t}=await n.ND.rpc("get_promoter_downline_tree",{p_promoter_code:e.promoter_id});if(t){const{data:s,error:t}=await n.ND.from("profiles").select("\n            id,\n            name,\n            email,\n            phone,\n            promoter_id,\n            role_level,\n            status,\n            parent_promoter_id,\n            pins,\n            created_at,\n            updated_at,\n            parent_promoter:parent_promoter_id(\n              id,\n              name,\n              promoter_id,\n              role\n            )\n          ").eq("role","promoter").eq("parent_promoter_id",e.id).order("created_at",{ascending:!1});return t?void A("Failed to load promoters: ".concat(t.message||"Unknown error")):R(s||[])}if(null!==s&&void 0!==s&&s.success&&null!==s&&void 0!==s&&s.downline_tree){const t=s.downline_tree,r=(t.map(e=>null).filter(Boolean),t.map(s=>{var r;let a=null;if(s.path&&s.path.length>1){const r=s.path[s.path.length-2];if(r!==e.promoter_id){const e=t.find(e=>e.code===r);e&&(a={id:e.id||r,name:e.name,promoter_id:e.code,role:"promoter"})}else a={id:e.id,name:e.name,promoter_id:e.promoter_id,role:"promoter"}}else a={id:e.id,name:e.name,promoter_id:e.promoter_id,role:"promoter"};return{id:s.id||s.code,name:s.name,email:s.email,phone:s.phone,promoter_id:s.code,role_level:s.role_level,status:s.status,parent_promoter_id:null===(r=a)||void 0===r?void 0:r.id,pins:0,created_at:s.created_at,updated_at:s.created_at,parent_promoter:a,hierarchy_level:s.level,hierarchy_path:s.path}}));return R(r)}N([]),_([]),w(!1)}catch(s){A("Failed to load promoters: "+s.message),w(!1)}finally{w(!1)}},R=e=>{if(!e)return N([]),_([]),O({total:0,level1:0,level2Plus:0,maxDepth:0}),void w(!1);const s=(e||[]).map((e,s)=>({id:(null===e||void 0===e?void 0:e.id)||s+1,promoter_id:(null===e||void 0===e?void 0:e.promoter_id)||"BPVP".concat(String(s+1).padStart(2,"0")),name:(null===e||void 0===e?void 0:e.name)||"Unknown Promoter",email:(null===e||void 0===e?void 0:e.email)||"No email",phone:(null===e||void 0===e?void 0:e.phone)||"No phone",joinDate:null!==e&&void 0!==e&&e.created_at?new Date(e.created_at).toISOString().split("T")[0]:"2024-01-01",affiliate_level:"Affiliate"===(null===e||void 0===e?void 0:e.role_level)?1:2,can_create_promoters:!0,can_create_customers:!0,commission_rate:.05,status:(null===e||void 0===e?void 0:e.status)||"Active",pins:(null===e||void 0===e?void 0:e.pins)||0,parent_promoter:(null===e||void 0===e?void 0:e.parent_promoter)||null,level:(null===e||void 0===e?void 0:e.level)||1,hierarchy_level:(null===e||void 0===e?void 0:e.hierarchy_level)||1,hierarchy_path:(null===e||void 0===e?void 0:e.hierarchy_path)||[],originalData:e})),t={total:s.length,level1:s.filter(e=>1===e.hierarchy_level).length,level2Plus:s.filter(e=>e.hierarchy_level>=2).length,maxDepth:s.length>0?Math.max(...s.map(e=>e.hierarchy_level||1)):0};N(s),_(s),O(t),w(!1)};(0,r.useEffect)(()=>{let e=b||[];P&&(e=e.filter(e=>{const s=((null===e||void 0===e?void 0:e.name)||"").toLowerCase(),t=((null===e||void 0===e?void 0:e.email)||"").toLowerCase(),r=((null===e||void 0===e?void 0:e.promoter_id)||"").toLowerCase(),a=((null===e||void 0===e?void 0:e.phone)||"").toLowerCase(),l=(P||"").toLowerCase();return s.includes(l)||t.includes(l)||r.includes(l)||a.includes(l)})),E&&"all"!==E&&(e=e.filter(e=>((null===e||void 0===e?void 0:e.status)||"active").toLowerCase()===E.toLowerCase())),_(e)},[b,P,E]);const Y=()=>{M(!1)};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.wE,{}),(0,f.jsx)(i.A,{}),(0,f.jsx)(d.dQ,{children:(0,f.jsx)("div",{className:"min-h-screen pt-40 px-8 pb-8",children:(0,f.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,f.jsxs)("div",{className:"flex justify-between items-center mb-8","data-animate":!0,children:[(0,f.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,f.jsx)("button",{onClick:()=>s("/promoter/home"),className:"p-2 rounded-lg bg-slate-700 hover:bg-slate-600 transition-colors",children:(0,f.jsx)(m.A,{className:"w-5 h-5 text-white"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"My Promoters"}),(0,f.jsx)("p",{className:"text-gray-300",children:"Manage and track your promoter network"}),k&&(0,f.jsxs)("p",{className:"text-red-400 text-sm mt-2",children:["\u26a0\ufe0f ",k]})]})]}),(0,f.jsxs)(d.Rq,{onClick:()=>M(!0),className:"flex items-center space-x-2",children:[(0,f.jsx)(u.A,{className:"w-5 h-5"}),(0,f.jsx)("span",{children:"Create Promoter"})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8","data-animate":!0,children:[(0,f.jsx)("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl p-6 shadow-lg",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-600 mb-1 font-medium",children:"Total Downline"}),(0,f.jsx)("p",{className:"text-3xl font-bold text-slate-900",children:T.total})]}),(0,f.jsx)("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:(0,f.jsx)(j.A,{className:"w-6 h-6 text-white"})})]})}),(0,f.jsx)("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl p-6 shadow-lg",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-600 mb-1 font-medium",children:"Level 1 (Direct)"}),(0,f.jsx)("p",{className:"text-3xl font-bold text-green-600",children:T.level1||0})]}),(0,f.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:(0,f.jsx)(h.A,{className:"w-6 h-6 text-white"})})]})}),(0,f.jsx)("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl p-6 shadow-lg",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-600 mb-1 font-medium",children:"Level 2+"}),(0,f.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:T.level2Plus||0})]}),(0,f.jsx)("div",{className:"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center",children:(0,f.jsx)(h.A,{className:"w-6 h-6 text-white"})})]})}),(0,f.jsx)("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl p-6 shadow-lg",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-600 mb-1 font-medium",children:"Max Depth"}),(0,f.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:T.maxDepth||0})]}),(0,f.jsx)("div",{className:"w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center",children:(0,f.jsx)(h.A,{className:"w-6 h-6 text-white"})})]})})]}),(0,f.jsx)(d.Xg,{className:"p-6 mb-8","data-animate":!0,children:(0,f.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,f.jsxs)("div",{className:"flex-1 relative",children:[(0,f.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,f.jsx)("input",{type:"text",placeholder:"Search by name, email, promoter ID, or phone...",value:P,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,f.jsx)("div",{className:"flex gap-4",children:(0,f.jsxs)("select",{value:E,onChange:e=>S(e.target.value),className:"px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,f.jsx)("option",{value:"all",children:"All Status"}),(0,f.jsx)("option",{value:"active",children:"Active"}),(0,f.jsx)("option",{value:"inactive",children:"Inactive"})]})})]})}),(0,f.jsxs)(d.Xg,{className:"overflow-hidden","data-animate":!0,children:[(0,f.jsx)("div",{className:"px-6 py-4 bg-gray-700 border-b border-gray-600",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("div",{children:(0,f.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center",children:[(0,f.jsx)(j.A,{className:"w-5 h-5 mr-2 text-blue-400"}),"Complete Downline Hierarchy"]})}),(0,f.jsxs)("div",{className:"text-sm text-gray-400",children:[y.length," of ",b.length," promoters"]})]})}),t?(0,f.jsx)("div",{className:"p-8",children:(0,f.jsx)(c.YB,{type:"promoters"})}):(0,f.jsx)("div",{className:"overflow-x-auto",children:(0,f.jsxs)("table",{className:"w-full",children:[(0,f.jsx)("thead",{className:"bg-gray-700",children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Promoter Details"}),(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Contact Details"}),(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Parent Promoter"}),(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Hierarchy Level"}),(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),(0,f.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Pins"})]})}),(0,f.jsx)("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:0===y.length?(0,f.jsx)("tr",{children:(0,f.jsx)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-400",children:0===b.length?"No promoters found. Start by creating your first promoter!":"No promoters match your search criteria."})}):y.map(s=>{var t,r,a,l;return(0,f.jsxs)("tr",{className:"hover:bg-gray-700",children:[(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center mr-3",children:(0,f.jsx)("span",{className:"text-white text-sm font-bold",children:((null===s||void 0===s?void 0:s.name)||"U").charAt(0)})}),(0,f.jsxs)("div",{className:"flex flex-col",children:[(0,f.jsx)("span",{className:"text-white font-medium",children:(null===s||void 0===s?void 0:s.name)||"Unknown Promoter"}),(0,f.jsx)("span",{className:"text-xs text-gray-400",children:(null===s||void 0===s?void 0:s.promoter_id)||"N/A"})]})]})}),(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(0,f.jsxs)("div",{className:"space-y-1",children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)(x.A,{className:"w-3 h-3 mr-2 text-gray-400"}),(null===s||void 0===s?void 0:s.email)||"No email"]}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)(p.A,{className:"w-3 h-3 mr-2 text-gray-400"}),(null===s||void 0===s?void 0:s.phone)||"No phone"]})]})}),(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(0,f.jsx)("div",{className:"flex items-center",children:"admin"===(null===s||void 0===s||null===(t=s.parent_promoter)||void 0===t?void 0:t.role)?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{className:"text-yellow-400 mr-2",children:"\ud83d\udc51"}),(0,f.jsx)("span",{className:"text-white font-medium",children:(null===s||void 0===s||null===(r=s.parent_promoter)||void 0===r?void 0:r.name)||"Admin"})]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(j.A,{className:"w-4 h-4 mr-2 text-blue-400"}),(0,f.jsxs)("div",{className:"flex flex-col",children:[(0,f.jsx)("span",{className:"text-white font-medium",children:(null===s||void 0===s||null===(a=s.parent_promoter)||void 0===a?void 0:a.name)||(null===e||void 0===e?void 0:e.name)||"You"}),(0,f.jsx)("span",{className:"text-xs text-gray-400",children:(null===s||void 0===s||null===(l=s.parent_promoter)||void 0===l?void 0:l.promoter_id)||"Parent"})]})]})})}),(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(0,f.jsx)("div",{className:"flex items-center",children:(0,f.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(1===(null===s||void 0===s?void 0:s.hierarchy_level)?"bg-green-100 text-green-800":2===(null===s||void 0===s?void 0:s.hierarchy_level)?"bg-blue-100 text-blue-800":3===(null===s||void 0===s?void 0:s.hierarchy_level)?"bg-purple-100 text-purple-800":"bg-orange-100 text-orange-800"),children:[(0,f.jsx)(h.A,{className:"w-3 h-3 mr-1"}),"Level ",(null===s||void 0===s?void 0:s.hierarchy_level)||1]})})}),(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(0,f.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("active"===((null===s||void 0===s?void 0:s.status)||"active").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"active"===((null===s||void 0===s?void 0:s.status)||"active").toLowerCase()?"\u2705 Active":"\u274c Inactive"})}),(0,f.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:(0,f.jsxs)("span",{className:"text-sm font-medium text-white",children:["\ud83d\udccc ",(null===s||void 0===s?void 0:s.pins)||0]})})]},s.id)})})]})})]}),U&&D&&(0,f.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,f.jsxs)("div",{className:"bg-slate-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,f.jsx)("div",{className:"p-6 border-b border-slate-700",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("h3",{className:"text-xl font-bold text-white",children:"Promoter Details"}),(0,f.jsx)("button",{onClick:()=>{q(!1),L(null)},className:"text-gray-400 hover:text-white transition-colors",children:(0,f.jsx)(v.A,{className:"w-6 h-6"})})]})}),(0,f.jsxs)("div",{className:"p-6",children:[(0,f.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,f.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center",children:(0,f.jsx)("span",{className:"text-white text-xl font-bold",children:((null===D||void 0===D?void 0:D.name)||"U").charAt(0)})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h4",{className:"text-xl font-bold text-white",children:(null===D||void 0===D?void 0:D.name)||"Unknown Promoter"}),(0,f.jsx)("p",{className:"text-gray-400",children:null===D||void 0===D?void 0:D.promoter_id}),(0,f.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mt-2 bg-green-100 text-green-800",children:"Active"})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h5",{className:"text-lg font-bold text-white mb-4",children:"Promoter Information"}),(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Email"}),(0,f.jsx)("span",{className:"text-white font-medium",children:(null===D||void 0===D?void 0:D.email)||"No email"})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Phone"}),(0,f.jsx)("span",{className:"text-white font-medium",children:(null===D||void 0===D?void 0:D.phone)||"No phone"})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Join Date"}),(0,f.jsx)("span",{className:"text-white font-medium",children:null!==D&&void 0!==D&&D.joinDate?new Date(D.joinDate).toLocaleDateString():"N/A"})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Affiliate Level"}),(0,f.jsx)("span",{className:"text-white font-medium",children:(null===D||void 0===D?void 0:D.level)>0?"Downline Level ".concat(null===D||void 0===D?void 0:D.level):"Level ".concat((null===D||void 0===D?void 0:D.affiliate_level)||1)})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Commission Rate"}),(0,f.jsxs)("span",{className:"text-white font-medium",children:[(100*((null===D||void 0===D?void 0:D.commission_rate)||.05)).toFixed(1),"%"]})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Can Create Promoters"}),(0,f.jsx)("span",{className:"font-medium ".concat(null!==D&&void 0!==D&&D.can_create_promoters?"text-green-400":"text-red-400"),children:null!==D&&void 0!==D&&D.can_create_promoters?"Yes":"No"})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-400",children:"Can Create Customers"}),(0,f.jsx)("span",{className:"font-medium ".concat(null!==D&&void 0!==D&&D.can_create_customers?"text-green-400":"text-red-400"),children:null!==D&&void 0!==D&&D.can_create_customers?"Yes":"No"})]})]}),(0,f.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,f.jsxs)(d.Rq,{className:"w-full flex items-center justify-center space-x-2",children:[(0,f.jsx)(x.A,{className:"w-4 h-4"}),(0,f.jsx)("span",{children:"Contact Promoter"})]}),(0,f.jsx)("button",{className:"w-full px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 transition-colors",children:"View Performance"})]})]})]})]})}),F&&(0,f.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,f.jsxs)("div",{className:"bg-slate-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,f.jsx)("div",{className:"p-6 border-b border-slate-700",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("h3",{className:"text-xl font-bold text-white",children:"Create New Promoter"}),(0,f.jsx)("button",{onClick:Y,className:"text-gray-400 hover:text-white transition-colors",children:(0,f.jsx)(v.A,{className:"w-6 h-6"})})]})}),(0,f.jsx)("div",{className:"p-6",children:(0,f.jsx)(o.A,{onSubmit:async s=>{try{if(!s.name||""===s.name.trim())throw new Error("Name is required for promoter creation.");if(!s.password||""===s.password.trim())throw new Error("Password is required for promoter creation.");if(!s.phone||""===s.phone.trim())throw new Error("Phone number is required for promoter creation.");const a=Date.now(),l=Math.floor(1e6*Math.random());let i,o,d="promo".concat(a).concat(l,"@brightplanet.com");try{const e=await fetch("http://localhost:5001/api/create-promoter-auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:s.password,userData:{role:"promoter",name:s.name,phone:s.phone}})});if(!e.ok)throw new Error("Backend service not available");i={user:(await e.json()).user}}catch(r){const e=await n.ND.auth.signUp({email:d,password:s.password,options:{emailRedirectTo:void 0,data:{role:"promoter",name:s.name,phone:s.phone}}});i=e.data,o=e.error}if(o){var t;if(null!==(t=o.message)&&void 0!==t&&t.includes("already registered"))throw new Error("Email ".concat(d," is already registered. Please try again."));throw new Error("Failed to create auth user: "+o.message)}if(!i.user)throw new Error("Failed to create auth user: No user data returned");const{error:c}=await n.ND.rpc("confirm_promoter_email",{p_user_id:i.user.id}),{data:m,error:h}=await n.ND.rpc("create_promoter_with_auth_id",{p_name:s.name.trim(),p_user_id:i.user.id,p_auth_email:d,p_password:s.password.trim(),p_phone:s.phone.trim(),p_email:s.email&&s.email.trim()?s.email.trim():null,p_address:s.address&&s.address.trim()?s.address.trim():null,p_parent_promoter_id:e.id,p_role_level:"Affiliate",p_status:"Active"});if(h)throw h;if(!m||!m.success)throw new Error((null===m||void 0===m?void 0:m.error)||"Failed to create promoter profile");await z(),Y(),alert("Promoter Created Successfully!\n\nPromoter ID: ".concat(m.promoter_id,"\nName: ").concat(m.name,"\nLogin: Use Promoter ID + Password"))}catch(k){alert("Failed to create promoter: ".concat(k.message))}},onCancel:Y,hideParentPromoter:!0,submitButtonText:"Create Promoter"})})]})})]})})})]})}},9256:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(3797).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}}]);
//# sourceMappingURL=745.c652b290.chunk.js.map